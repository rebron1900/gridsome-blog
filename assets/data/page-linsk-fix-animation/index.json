{"hash":"0810a28e7848218696784bc8b33ad1e40c9e72dc","data":{"metadata":{"siteName":"只是玩玩 | JUST FUN","siteDescription":"Hello"},"post":{"id":"63158312cf533d1c2cf299bd","title":"页内锚点滚动修正及动画效果","content":"<!--kg-card-begin: markdown--><p>昨天在写引用时发现了一个页面上的BUG，在页面上点击文章内的对应的引用数字会跳转到页脚对应的引用区。但是因为我页面的头部有一条固定高度为<code>50px</code>的导航条，点击连接后虽然会跳转到引用区域，但是会被导航条遮住50px高度的内容。而且跳转没有过渡动画，很僵硬...</p>\n<p>感觉这个可以用回到顶部中用到的修改元素的<code>data-offset</code>来解决这个问题，起初是想直接用js上的一个滚动框架来实现这个功能，后来发现改不来。干脆照着自己写了个函数。</p>\n<p>先是查找下页面上所有锚点链接并用jquery绑定一个新的点击事件，选择器可以用css的属性选择器写法如<code>a[href^=&quot;#&quot;]</code>过滤所有以#符号开头的a链接。绑定一个点击函数，用<code>preventDefault</code>阻值默认的点击事件，然后用jquery的<code>animate</code>来实现动画效果的滚动，并滚动滚动条到目标元素的位置，并加上我导航条的高度修正<code>scrollTop: $(this.hash).offset()-55</code>，最终代码如下。</p>\n<pre><code class=\"language-javascript\">$('.post-content sup a[href^=&quot;#&quot;]').click(function(e){\n                    e.preventDefault();\n                    $('html, body').animate({scrollTop: $(this.hash).offset()-55}, 400);\n                });\n</code></pre>\n<p>后来发现还有其他地方需要用到这个东西来做页面内的定位(比如定位到comment区等等)，所以把代码提取优化了一下，做了一个函数如下：</p>\n<pre><code class=\"language-javascript\">function linkEV(selector,fixSet = 0){\n\t$(selector).click(function(e){\n                    e.preventDefault();\n                    $('html, body').animate({scrollTop: $(this.hash).offset().top+fixSet}, 400);\n                });\n}\n</code></pre>\n<p>调用，传入不同选择器和修正数值即可灵活引用了。</p>\n<pre><code class=\"language-javascript\">linkEV('.post-content blockquote[id^=&quot;fn&quot;]  a[href^=&quot;#&quot;]',-55);\nlinkEV('.post-content sup a[href^=&quot;#&quot;]',-55);\n</code></pre>\n<p>具体效果可以看我<a href=\"https://1900.live/auto-push-hexo/\">这篇文章</a></p>\n<iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=\"100%\" height=\"86\" src=\"//music.163.com/outchain/player?type=2&id=513357806&auto=1&height=66\"></iframe><!--kg-card-end: markdown-->","date":"31 October 2017","path":"page-linsk-fix-animation"}},"context":{}}