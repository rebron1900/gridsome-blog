{"hash":"2cbfaa773c414da5c97e6a0cf2cb9fa9d7db58ae","data":{"metadata":{"siteName":"只是玩玩 | JUST FUN","siteDescription":"Hello"},"post":{"id":"63158312cf533d1c2cf29b41","title":"Godot游戏引擎学习 课外学习：新场景 2","content":"<!--kg-card-begin: markdown--><h2 id>新怪物：飞鱼</h2>\n<p>做了一个从屏幕右侧往玩家方向无视碰撞快速飞行的飞鱼怪物，并让拓展了之前写的怪物笼场景，可以让怪物随机生成。</p>\n<p>随机效果是通过获取游戏场景的高度并乘以一个随机生成的小数达到随机效果，并设置了外部变量让玩家可以控制是否随机生成，且增加了怪物数量的上限</p>\n<p>不过目前随机效果不太理想，之后可能要进行改进，设置成固定区域生成，而且飞鱼飞出屏幕之外后还需要让它自我销毁避免占用资源。</p>\n<p>具体代码如下：</p>\n<pre><code class=\"language-python\">extends Position2D\n\n# 让外部可以设置打包场景\nexport var enemy_scene: PackedScene\n# 刷新速度\nexport var interval = 1.0\n# 怪物上限\nexport var max_enmey = 5\n# 是否随机\nexport var rand_position = false\n\n#定时器\nonready var timer =$Timer\n# 初始怪物数量统计\nvar enemy_count = 0\n\nfunc _ready():\n\t# 如果设置了打包场景\n\tif enemy_scene:\n\t\t# 开始计时\n\t\ttimer.start(interval)\n\t\t\n\n# 每进行一次循环完毕的信号\nfunc _on_Timer_timeout():\n\t# 如果当前怪物数量统计超过上限则重置为零，继续循环生成\n\tif enemy_count &gt; max_enmey:\n\t\tenemy_count = 0\n\t\treturn\n\t\n\t# 根据设置的打包场景实例化新的怪物对象\n\tvar enemy: Node2D = enemy_scene.instance()\n\t# 将实例化后的怪物添加到父节点中\n\tget_parent().add_child(enemy)\n\t# 并将位置设置为Position的节点\n\t# 判断是否设置了随机生成\n\tif rand_position:\n\t\t# 如果设置了则获取当前视窗高度乘以一个随机的百分比小数\n\t\tvar rand_position_y = get_viewport().size.y * randf()\n\t\t# 并讲posistion设置为随机点\n\t\tenemy.global_position = Vector2(global_position.x, rand_position_y)\n\t# 如果没设置随机生成则出生在刷新点。\n\telse:\n\t\tenemy.global_position = global_position;\n\t\tprint(global_position)\n\t# 添加完后统计数+1\t\n\tenemy_count += 1\n</code></pre>\n<p>飞鱼的代码基本上和Slime一致，我这里就不贴代码了。</p>\n<pre><code class=\"language-python\">extends &quot;res://src/enemies/Enemy.gd&quot;\n\nfunc _ready():\n\t# 飞鱼的移动速度更快，但是是直线运动\n\tmax_speed = 500\n\nfunc _physics_process(_delta):\n\t# 进行移动操作\n\tvelocity = move_and_slide(velocity, Vector2.UP)\n\nfunc _process(delta):\n\t# 如果死了则移动向量设为0\n\tif is_dead:\n\t\tvelocity.x = 0\n\t\t# 增加重力，下怪物下坠\n\t\tvelocity.y += gravity * delta\n\telse:\n\t# 进行加速移动\n\t\tvelocity.x = move_toward(velocity.x, max_speed * direction, max_speed * delta)\n</code></pre>\n<h2 id>效果如下</h2>\n<p><img src=\"https://cdn.1900.live/typora/%E7%AC%AC%E4%B9%9D%E8%AF%BE_flyfish-1609252446608.gif\" alt=\"第九课_flyfish\" loading=\"lazy\"></p>\n<!--kg-card-end: markdown-->","date":"29 December 2020","path":"godot_game_engine_extracurricular_learning-__new_scenario_2"}},"context":{}}