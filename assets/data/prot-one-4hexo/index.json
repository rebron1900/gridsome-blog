{"hash":"c29e28eb09cebfa4d5785bfac51829c54a26be66","data":{"metadata":{"siteName":"只是玩玩 | JUST FUN","siteDescription":"Hello"},"post":{"id":"63158312cf533d1c2cf299c0","title":"主题ONE的移植","content":"<!--kg-card-begin: markdown--><h3 id=\"hexo\">又想喷hexo的文档了</h3>\n<p>归功于现在主题的高度模块化，模版引擎简单易用，所以移植的过程其实来说还是比较简单了。不过实在是还想再喷一下hexo的文档，写的是真的烂，不不，应该说那是一坨<code>shi</code>，整个文档写的不明不白。</p>\n<p>比如说<code>site.posts</code>这个变量获取到的文章列表并不会按时间排序，恰好我有一个归档功能需要所有按时间从新到旧的文章列表，翻遍官方的手册没发现有相关排序函数的叙述，之后在github的issue上看到有网友提到想关的用发，最后以如下形式实现这个功能</p>\n<pre><code>&lt;% var posts = site.posts.sort('-date');\nposts.each(function(post){ %&gt;\n&lt;li class=&quot;&quot; itemscope=&quot;&quot; itemtype=&quot;http://schema.org/Article&quot;&gt;\n  &lt;a class=&quot;&quot; href=&quot;&lt;%- post.permalink %&gt;&quot; itemprop=&quot;url&quot;&gt;\n    &lt;em year=&quot;&lt;%- date(post.date, 'YYYY') %&gt;&quot;&gt;\n      &lt;%- date(post.date, 'MM-DD') %&gt;\n    &lt;/em&gt;\n    &lt;span itemprop=&quot;name&quot;&gt;&lt;%- post.title %&gt;&lt;/span&gt;\n  &lt;/a&gt;\n&lt;/li&gt;\n&lt;% }); %&gt;\n</code></pre>\n<p>你在把官方的手册翻烂都找不出这个函数的用法。不过不排除这个函数其实是ejs里的，但是点开官方提供的ejs链接后去了官网也没看到有相关的使用文档。希望不是我的姿势不对所引起的</p>\n<p>所以我基本上是属于大部分看其他作者主题的实现，小部分看官方文档解决的。（刚刚在看issue的时候发现<code>page.posts.data[0]</code>这样即可访问第一篇文章。写文档的你多写几个demo会死吗。。。）</p>\n<h3 id>移植时发现的一些要注意的地方</h3>\n<h4 id>配置文件</h4>\n<p>因为没有数据，所以一些博客的设置、主题的设置都需要放进<code>_config.yml</code>里面，在ghost上时我基本上都把配置文件写死在主题里。正好这次移植主题所以我增加了很多定制都写进了配置文件里，这里也首次接触了yaml语言。</p>\n<pre><code># Menu\nmenu:\n    index: /\n    links: /links.html\n    archive: /archive.html\n    about: /about.html\n    rss: /rss.xml\n\n# SNS Menu\nsns:\n    email: trax.long@gmail.com\n\n# site info\ninfo:\n    location: 自贡\n    website: \n    description: 我叫1900，普通男青年，学过三年编程。湖南人，现在在四川工作。2015年花了26天骑过一次318。有点伪文艺，喜欢比较玄学的东西。性格多变，疑似有人格分裂。\n\n# Images Settings\nimg:\n    logo: &quot;/img/logo.png&quot;\n    mini_logo: &quot;/img/logo-mini.png&quot;\n    default_thum: &quot;https://cdn.1900.live/default.jpg&quot;\n    avatar: &quot;/img/avatar.png&quot;\n    daily_pic: &quot;/img/daily_pic.png&quot;\n    sidebar_header: &quot;/img/sidebar_header.png&quot;\n    random_thumbnail: &quot;/img/random/material-&quot;\n    footer_image: \n</code></pre>\n<h4 id>多语言</h4>\n<p>在做菜单功能的时候发现写好的菜单配置项输出到页面上时是英文。才想起因为使用了yaml，所以我写配置文件的时候都是英文的字段名。后来查了下手册上的<a href=\"https://hexo.io/zh-cn/docs/internationalization.html?ref=1900.live\">国际化</a>这一项里有说到怎么操作。首先在主题目录下增加一个如下结构的目录</p>\n<pre><code class=\"language-yaml\">/根目录\n\t/languages/\n\t/languages/zh-cn.yml\n</code></pre>\n<p>然后修改<code>zh-cn.yml</code>文件，里面增加你主题配置文件的对应字段的中文即可，如下：</p>\n<pre><code>categories: 分类\nsearch: 搜索\ntags: 标签\ntagcloud: 标签云\ntweets: 推文\nprev: 上一页\nnext: 下一页\ncomment: 留言\narchive_a: 归档\narchive_b: 归档：%s\npage: 第 %d 页\nrecent_posts: 最新文章\nnewer: Newer\nolder: Older\nshare: Share\npowered_by: Powered by\nrss_feed: RSS Feed\ncategory: Category\ntag: Tag\n\nindex: 首页\nlinks: 左邻\nbooks: 书单\narchive: 归档\nabout: 关于\nrss: 订阅\n</code></pre>\n<p>然后模版上使用<code>&lt;%= __('index.index') %&gt;</code>函数即可在用户设置系统语言为<code>zh-cn</code>的时候自动使用中文显示相关字段。</p>\n<h3 id>移植情况</h3>\n<ol>\n<li>~~首页：基本已经完成，只差tag、评论数</li>\n<li>文章内页：基本已经完成，只差tag、评论数</li>\n<li>tag页面</li>\n<li><s>page页面：基本已经完成</s></li>\n<li>分类页面</li>\n<li><s>顶部菜单：基本已经完成</s></li>\n<li><s>文章归档：基本已经完成</s></li>\n<li>订阅：基本已完成</li>\n<li><s>评论系统：还是使用fooleap的方案，前端由于是js的所以可以很方便的直接粘贴代码过来即可，但是目前因为域名还没更改所以使用www.1900.live访问本站时可能无法正常评论，请使用以前的老域名www.4zen.top访问本站即可正常评论。</s></li>\n<li>订阅：基本已完成</li>\n</ol>\n<!--kg-card-end: markdown-->","date":"27 October 2017","path":"prot-one-4hexo"}},"context":{}}