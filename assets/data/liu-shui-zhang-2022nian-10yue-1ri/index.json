{"hash":"c29e28eb09cebfa4d5785bfac51829c54a26be66","data":{"metadata":{"siteName":"只是玩玩 | JUST FUN","siteDescription":"Hello"},"post":{"id":"633802f46ba034063f06d0bb","title":"流水账 2022年10月1日","content":"<p>这个国庆没有安排~。</p><p>不同于往年每个国庆基本上都出去浪荡了，鉴于目前四川疫情形式所以我们今年就窝在家里和公司七日游了。</p><p>另外最近虽然博客文章更新的比较少，但是数字花园那边记录了不少东西，因为都是知识一类的我就没有再写进博客里了，不过这里倒是可以做个整理，清点一下到底都写了些啥。</p><p>唠唠最近发生了啥大事把~。</p><h3 id=\"%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92\">服务器中勒索病毒</h3><div class=\"kg-card kg-callout-card kg-callout-card-red\"><div class=\"kg-callout-emoji\">⚠️</div><div class=\"kg-callout-text\">请一定要给服务器重要数据定时做好备份！切记！</div></div><p>前些天刚到公司就听到服务器传来噩耗，大家都说ERP连不上了，我还不信，开了自己的电脑测试发现果然不行，而且远程软件也没办法连接。</p><p>我疑惑的接上显示器和键鼠登录系统后才发现——我们服务器中勒索病毒了，我之前装的各种安全手段全部失效，安全软件也被干掉了，所有的文件都被加密。并且硬盘分区名称都被改成了邮箱，根目录有一个 <code>README.md</code> 文件，里面写了以前勒索病毒的常见说辞，大概意思就是不要动文件，24个小时之类马上联系我们支付赎金就给你恢复balabla..。</p><p>不过我是不太信这种的，一般都不会给你恢复的。所以中了这种病毒去一些安全论坛发帖问问看那些安全人员有没有办法恢复，没有的话你就只能认了。</p><p>服务被攻破也许是必然的，我以前刚部署完后就发现服务器一直有人在暴力爆破1433端口的数据库，但是我挂了<a href=\"https://github.com/glasnt/wail2ban?ref=1900.live\"><strong>wail2ba</strong></a><strong> </strong>后以为可以ban掉别人的所有ip，但是没想到还是被攻破了，而且以前的数据密码是个只有4位的超简单密码，因为是以前工程师部署时就使用的密码，所有门店也都用的这个，我嫌麻烦就一直没改。</p><p>以前一直都是看别人发的贴子说自己中病毒了，现在自己中了才感觉有点奇幻，而且感觉网络上的东西其实离自己好近。</p><p>数据安全这种东西真的一点玩笑都开不得，如果数据丢失了真的会造成非常大的损失和一连串的蝴蝶效应。</p><figure class=\"kg-card kg-gallery-card kg-width-wide\"><div class=\"kg-gallery-container\"><div class=\"kg-gallery-row\"><div class=\"kg-gallery-image\"><img src=\"https://cdn.1900.live/assets/2022/10/016b2d7d90159435837111bd7f6d648c39.jpg\" width=\"2560\" height=\"1920\" loading=\"lazy\" alt></div><div class=\"kg-gallery-image\"><img src=\"https://cdn.1900.live/assets/2022/10/01f25f40273461fe01981e43084fff3caf.jpg\" width=\"1440\" height=\"705\" loading=\"lazy\" alt></div></div></div></figure><p>还好我不是一点安全意识都没有，之前因为1433被攻击的原因有给系统做过自动备份的设置。</p><p>所以，我就准备自己处理了。我之前利用 <a href=\"https://www.disktool.cn/backup/backup-software.html?ref=1900.live\">傲梅轻松备份</a> 每天都给系统、重要数据做了自动数据备份，并且自动同步到我的Onedrive里，而且Onedrive自带历史版本的功能，即便是当前版本数据无法恢复也可以通过这个功能获取到没被修改之前备份的数据。</p><figure class=\"kg-card kg-gallery-card kg-width-wide\"><div class=\"kg-gallery-container\"><div class=\"kg-gallery-row\"><div class=\"kg-gallery-image\"><img src=\"https://cdn.1900.live/assets/2022/10/01ea37e1e1b6539cdadf1f6409555b3015.jpg\" width=\"1440\" height=\"705\" loading=\"lazy\" alt></div><div class=\"kg-gallery-image\"><img src=\"https://cdn.1900.live/assets/2022/10/016278439c438dd7b44da2f06da9fdaf85.jpg\" width=\"1440\" height=\"705\" loading=\"lazy\" alt></div></div></div></figure><figure class=\"kg-card kg-image-card\"><img src=\"https://cdn.1900.live/assets/2022/10/01089991990f03a2a9c7a7d98c30654705.jpg\" class=\"kg-image\" alt loading=\"lazy\" width=\"1440\" height=\"705\"></figure><p>另外强烈推荐一下这个软件：傲梅轻松备份！这个软件是成都的一个公司开发的，国内目前推广的比较少，主要做国外市场。个人版可以免费使用，可以替代Win7以前盛行的Ghost备份工具。</p><p>如果是服务器用也不贵，只需要498元即可实现系统完整备份、增量备份、差异备份、云端备份，文件的镜像备份、增量备份等等很多类型的备份功能（支持的类型很多，我这里没写全）。而且还可以用系统备份文件直接进行系统还原，类似以前的win7时代以前盛行的Ghost备份，因为Windows Server系统没法用，那个时候担心数据安全，所以找了它来替代Ghost备份的，从目前的结果来看我没选错😂。</p><div class=\"kg-card kg-callout-card kg-callout-card-grey\"><div class=\"kg-callout-emoji\">👍</div><div class=\"kg-callout-text\">傲梅轻松备份：<a href=\"https://www.disktool.cn/download.html?ref=1900.live\">https://www.disktool.cn/download.html</a></div></div><p>而且他们客服反应速度超快，服务态度超好！（说个囧事，我当时备份的时候给备份文件加密了，还原的时候好像忘了密码，找了他们客服咨询，服务态度超好。还好我后来试出来了，他们说没有密码大概率解不出来，但是还是可以帮我找下工程师试试。）</p><p>之后我再专门写个文章来案例一下这个软件。</p><hr><p>虽然整个系统我通过系统还原回来了，但是担心还有残留的勒索病毒，整个系统不敢用了，把一些重要的文件做好备份后我选择直接重新分区做了个新的系统。但是C盘外的其他分区里的次要文件都没办法恢复了。</p><p>我折腾了三四天，每天基本上都到晚上2点后终于把系统重新安装好，把服务器环境配置好，重新上线ERP，恢复正常使用。</p><p>安装好新的系统后给系统做了全面的安全加强处理，系统口令、数据库口令全部换成高强度随机密码，并且更改了一些默认端口，并根据一些网上的资料进行了系统和数据库的双重加固，并把相关的资料都写进了我的数字花园里。</p><p>我总结如下：</p><ul><li>所有相关密码使用强密码（我使用的12位随机密码，每次登录都要打开bitwarden对比），并且定期更新。</li><li>使用防火墙，并且设置入站规则</li><li>关掉一些危险端口，如3389，1433等。</li><li>如果必须要用也请更改3389，1433端口，不要使用默认的。</li><li>定期查看系统安全日志</li><li>定期做好备份！这一点非常重要</li></ul><hr><p>好了，开始清点最近在数字花园里新增的资料。</p><h3 id=\"%E6%95%B0%E5%AD%97%E8%8A%B1%E5%9B%AD%E6%9C%80%E8%BF%91%E6%96%B0%E5%A2%9E\">数字花园最近新增</h3><ul><li><a href=\"https://garden.1900.live/?ref=1900.live#/page/windows%20server%202016%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8A%A0%E5%9B%BA\">Windows Server 2016 服务器加固</a> #系统相关</li><li><a href=\"https://garden.1900.live/?ref=1900.live#/page/sqlserver2008%20%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA\">SqlServer2008 安全加固</a> #系统相关</li><li><a href=\"https://garden.1900.live/?ref=1900.live#/page/sqlserver2008%E5%AE%89%E8%A3%85%E6%97%B6%E5%8D%A1%E5%9C%A8%E5%AE%89%E8%A3%85%E6%94%AF%E6%8C%81%E6%96%87%E4%BB%B6\">SqlServer2008 安装时卡在安装支持文件</a> #系统相关</li><li><a href=\"https://garden.1900.live/?ref=1900.live#/page/u%E7%9B%98%E9%95%9C%E5%83%8F%E5%88%BB%E5%BD%95%E5%B7%A5%E5%85%B7%EF%BC%9Arufus\">U 盘镜像刻录工具：Rufus</a> #工具相关</li><li><a href=\"https://garden.1900.live/?ref=1900.live#/page/mysql%20login-path\">MySql login-path</a> #开发相关</li><li><a href=\"https://garden.1900.live/?ref=1900.live#/page/umami%E6%89%8B%E5%8A%A8%E8%AE%B0%E5%BD%95%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE\">Umami 手动记录访问数据</a> #工具相关</li><li><a href=\"https://garden.1900.live/?ref=1900.live#/page/tailscale%E5%BC%80%E5%90%AF%E5%90%8Eclash%E7%BD%91%E7%BB%9C%E5%BC%82%E5%B8%B8\">Tailscale 开启后 Clash 网络异常</a> #工具相关</li><li><a href=\"https://garden.1900.live/?ref=1900.live#/page/%E5%B0%8F%E7%B1%B3ax5%E5%BC%80%E5%90%AFssh%E6%96%B9%E6%B3%95\">小米AX5开启SSH方法</a> #其他</li></ul>","date":"1 October 2022","path":"liu-shui-zhang-2022nian-10yue-1ri"}},"context":{}}