<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>只是玩玩 | JUST FUN - 只是玩玩 | JUST FUN</title><meta name="gridsome:hash" content="2cbfaa773c414da5c97e6a0cf2cb9fa9d7db58ae"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Hello"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/gridsome-blog/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/gridsome-blog/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/gridsome-blog/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/gridsome-blog/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/gridsome-blog/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/gridsome-blog/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/gridsome-blog/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/gridsome-blog/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/gridsome-blog/assets/css/0.styles.be694e5c.css" as="style"><link rel="preload" href="/gridsome-blog/assets/js/app.d87bab28.js" as="script"><link rel="preload" href="/gridsome-blog/assets/js/page--src--templates--ghost-post-vue.a078e51b.js" as="script"><link rel="prefetch" href="/gridsome-blog/assets/js/5.fd828304.js"><link rel="prefetch" href="/gridsome-blog/assets/js/page--node-modules--gridsome--app--pages--404-vue.5fb9a6b8.js"><link rel="prefetch" href="/gridsome-blog/assets/js/page--src--pages--index-vue.48502cc5.js"><link rel="stylesheet" href="/gridsome-blog/assets/css/0.styles.be694e5c.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body  class="darkmode">
    <main role="main" data-server-rendered="true" id="app" class="container"><div class="row"><header class="header"><a href="/gridsome-blog/" class="active"><h1>👨‍💻 只是玩玩 | JUST FUN</h1></a><!----></header><div class="article"><h1 class="article-title">用emoji-mart替换twikoo的emoji选择器</h1><p class="article-date"> 10 September 2022 · <i> min read</i></p><article><h3 id="%E5%89%8D%E8%A8%80">前言</h3><p>我用twikoo也有好几年了，说实话从idisqus换过来后使用起来的感觉是非常舒适的，后来也试过valin(好像是这个名字)之类的其他自建评论工具，但是使用起来觉得没有twikoo舒服，还是很推荐这个评论工具的。</p><p>但是，twikoo的表情工具说实话是有些简陋的，虽然可以自定义Emotion.json来丰富可用的表情列表。但是界面不美观，可选择范围始终太窄，所以今天折腾一下它。</p><h3 id="emoji-mart">emoji-mart</h3><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://github.com/missive/emoji-mart?ref=1900.live#-internationalization"><div class="kg-bookmark-content"><div class="kg-bookmark-title">GitHub - missive/emoji-mart: 🏪 One component to pick them all</div><div class="kg-bookmark-description">🏪 One component to pick them all. Contribute to missive/emoji-mart development by creating an account on GitHub.</div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://github.com/fluidicon.png" alt><span class="kg-bookmark-author">GitHub</span><span class="kg-bookmark-publisher">missive</span></div></div><div class="kg-bookmark-thumbnail"><img src="https://repository-images.githubusercontent.com/63091815/e0e2b113-1c2c-4dd9-b12b-ab8111d68c9d" alt></div></a></figure><p>emoji-mart是github上开源的一个emoji前端组件，基本上和现在手机上输入法使用的emoji功能一致，而且提供的emoji图标更为丰富，包含以下特性</p><ul><li>多平台emoji源：Native、apple、facebook、google、twitter..</li><li>light和dark主题颜色</li><li>和指定任意版本emoji</li><li>本地化（有中文，但是我上传到服务上后又不显示中文了...）</li><li>多肤色</li><li>可以快捷搜索emoji</li><li>等等..</li></ul><p>总的来说是一款相当优秀的开源工具，但是无法动态更改主题颜色（可能是我的使用方式不对，希望有大佬指证），也有外国人吐槽过这个组件，那个人还另外写了另外一个工具：<a href="https://github.com/nolanlawson/emoji-picker-element?ref=1900.live">emoji-picker-element</a> 。</p><h3 id="%E5%A6%82%E4%BD%95%E9%9B%86%E6%88%90%E5%88%B0twikoo">如何集成到twikoo</h3><p>利用twikoo的init的回调事件 <code>onCommentLoaded</code> 我们可以在评论加载完成后开始集成emoji-mart。</p><div class="kg-card kg-callout-card kg-callout-card-grey"><div class="kg-callout-emoji">💡</div><div class="kg-callout-text">注意：twikoo的onCommentLoaded其实twikoo并没有完全加载完毕，经过我的测试twikoo原生的表情功能是在这个事件结束后才开始调用的，所以这里要 <code>关闭掉twikoo的原生表情功能</code>&nbsp;</div></div><figure class="kg-card kg-code-card"><pre><code class="language-html">&lt;script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emoji-mart@latest/dist/browser.js"&gt;</code></pre><figcaption>引入emoji-mart库</figcaption></figure><figure class="kg-card kg-code-card"><pre><code class="language-html">&lt;div id="tcomment"&gt;&lt;/div&gt;
&lt;script&gt;twikoo.init({ 
	envId: '{{@custom.disqus_shortname}}', 
	el: '#tcomment',
	onCommentLoaded: function () {
			console.log('评论加载完成');

			//初始化自定义emojimart
			const pickerOptions = { 
				onEmojiSelect: function(d){ $('.el-textarea__inner').val($('.el-textarea__inner').val() + d.native)  },
				locale: 'zh',theme : 'dark'
			}
			const picker = new EmojiMart.Picker(pickerOptions)
            //把html注入网页内
			$('.tk-row-actions-start').append(picker)
        	//因为div默认不能使用focus事件，加上tabindex才可以
			$('em-emoji-picker').attr('tabindex','5')
			$('.OwO').show().click(function(){
				$('em-emoji-picker').toggle()
				$('em-emoji-picker').focus()
			})
			$('em-emoji-picker').blur(function(){
				$('em-emoji-picker').toggle()
			})
			
		}
	})
	
&lt;/script&gt;</code></pre><figcaption>进行初始化</figcaption></figure><figure class="kg-card kg-code-card"><pre><code class="language-css">em-emoji-picker{
    display: none;
    position: absolute;
    top: 3rem;
    z-index: 2;
}</code></pre><figcaption>增加一点简单的样式处理</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://cdn.1900.live/assets/2022/09/10image.png" class="kg-image" alt loading="lazy" width="966" height="867"><figcaption>效果图</figcaption></figure><h3 id="%E5%BE%85%E5%AE%8C%E5%96%84">待完善</h3><p>因为目前的emoji-mart没办法动态改变主题，所以目前暂时还没有实现主题的联动，希望作者后续能进行改进。</p><h3 id="%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">参考链接</h3><ul><li>div失去焦点事件 - <a href="https://blog.csdn.net/vip545058/article/details/24296865?ref=1900.live">https://blog.csdn.net/vip545058/article/details/24296865</a></li></ul></article></div><div class="footer"><div><p>
          Built with
          <a target="_blank" href="//gridsome.org" class="link">Gridsome</a>
          &amp; Made with ❤️ by
          <a target="_blank" href="//alex.design" class="link">Alex Brown</a></p></div><div class="footer-links"><a target="_blank" href="/sitemap.xml">Sitemap</a><a target="_blank" href="/feed.xml">RSS Feed</a></div></div></div></main>
    <script>window.__INITIAL_STATE__={"data":{"metadata":{"siteName":"只是玩玩 | JUST FUN","siteDescription":"Hello"},"post":{"id":"631c110d3236fa0a46811299","title":"用emoji-mart替换twikoo的emoji选择器","content":"\u003Ch3 id=\"%E5%89%8D%E8%A8%80\"\u003E前言\u003C\u002Fh3\u003E\u003Cp\u003E我用twikoo也有好几年了，说实话从idisqus换过来后使用起来的感觉是非常舒适的，后来也试过valin(好像是这个名字)之类的其他自建评论工具，但是使用起来觉得没有twikoo舒服，还是很推荐这个评论工具的。\u003C\u002Fp\u003E\u003Cp\u003E但是，twikoo的表情工具说实话是有些简陋的，虽然可以自定义Emotion.json来丰富可用的表情列表。但是界面不美观，可选择范围始终太窄，所以今天折腾一下它。\u003C\u002Fp\u003E\u003Ch3 id=\"emoji-mart\"\u003Eemoji-mart\u003C\u002Fh3\u003E\u003Cfigure class=\"kg-card kg-bookmark-card\"\u003E\u003Ca class=\"kg-bookmark-container\" href=\"https:\u002F\u002Fgithub.com\u002Fmissive\u002Femoji-mart?ref=1900.live#-internationalization\"\u003E\u003Cdiv class=\"kg-bookmark-content\"\u003E\u003Cdiv class=\"kg-bookmark-title\"\u003EGitHub - missive\u002Femoji-mart: 🏪 One component to pick them all\u003C\u002Fdiv\u003E\u003Cdiv class=\"kg-bookmark-description\"\u003E🏪 One component to pick them all. Contribute to missive\u002Femoji-mart development by creating an account on GitHub.\u003C\u002Fdiv\u003E\u003Cdiv class=\"kg-bookmark-metadata\"\u003E\u003Cimg class=\"kg-bookmark-icon\" src=\"https:\u002F\u002Fgithub.com\u002Ffluidicon.png\" alt\u003E\u003Cspan class=\"kg-bookmark-author\"\u003EGitHub\u003C\u002Fspan\u003E\u003Cspan class=\"kg-bookmark-publisher\"\u003Emissive\u003C\u002Fspan\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"kg-bookmark-thumbnail\"\u003E\u003Cimg src=\"https:\u002F\u002Frepository-images.githubusercontent.com\u002F63091815\u002Fe0e2b113-1c2c-4dd9-b12b-ab8111d68c9d\" alt\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003C\u002Ffigure\u003E\u003Cp\u003Eemoji-mart是github上开源的一个emoji前端组件，基本上和现在手机上输入法使用的emoji功能一致，而且提供的emoji图标更为丰富，包含以下特性\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E多平台emoji源：Native、apple、facebook、google、twitter..\u003C\u002Fli\u003E\u003Cli\u003Elight和dark主题颜色\u003C\u002Fli\u003E\u003Cli\u003E和指定任意版本emoji\u003C\u002Fli\u003E\u003Cli\u003E本地化（有中文，但是我上传到服务上后又不显示中文了...）\u003C\u002Fli\u003E\u003Cli\u003E多肤色\u003C\u002Fli\u003E\u003Cli\u003E可以快捷搜索emoji\u003C\u002Fli\u003E\u003Cli\u003E等等..\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E总的来说是一款相当优秀的开源工具，但是无法动态更改主题颜色（可能是我的使用方式不对，希望有大佬指证），也有外国人吐槽过这个组件，那个人还另外写了另外一个工具：\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fnolanlawson\u002Femoji-picker-element?ref=1900.live\"\u003Eemoji-picker-element\u003C\u002Fa\u003E 。\u003C\u002Fp\u003E\u003Ch3 id=\"%E5%A6%82%E4%BD%95%E9%9B%86%E6%88%90%E5%88%B0twikoo\"\u003E如何集成到twikoo\u003C\u002Fh3\u003E\u003Cp\u003E利用twikoo的init的回调事件 \u003Ccode\u003EonCommentLoaded\u003C\u002Fcode\u003E 我们可以在评论加载完成后开始集成emoji-mart。\u003C\u002Fp\u003E\u003Cdiv class=\"kg-card kg-callout-card kg-callout-card-grey\"\u003E\u003Cdiv class=\"kg-callout-emoji\"\u003E💡\u003C\u002Fdiv\u003E\u003Cdiv class=\"kg-callout-text\"\u003E注意：twikoo的onCommentLoaded其实twikoo并没有完全加载完毕，经过我的测试twikoo原生的表情功能是在这个事件结束后才开始调用的，所以这里要 \u003Ccode\u003E关闭掉twikoo的原生表情功能\u003C\u002Fcode\u003E&nbsp;\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cfigure class=\"kg-card kg-code-card\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-html\"\u003E&lt;script type=\"text\u002Fjavascript\" src=\"https:\u002F\u002Fcdn.jsdelivr.net\u002Fnpm\u002Femoji-mart@latest\u002Fdist\u002Fbrowser.js\"&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cfigcaption\u003E引入emoji-mart库\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"kg-card kg-code-card\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-html\"\u003E&lt;div id=\"tcomment\"&gt;&lt;\u002Fdiv&gt;\n&lt;script&gt;twikoo.init({ \n\tenvId: '{{@custom.disqus_shortname}}', \n\tel: '#tcomment',\n\tonCommentLoaded: function () {\n\t\t\tconsole.log('评论加载完成');\n\n\t\t\t\u002F\u002F初始化自定义emojimart\n\t\t\tconst pickerOptions = { \n\t\t\t\tonEmojiSelect: function(d){ $('.el-textarea__inner').val($('.el-textarea__inner').val() + d.native)  },\n\t\t\t\tlocale: 'zh',theme : 'dark'\n\t\t\t}\n\t\t\tconst picker = new EmojiMart.Picker(pickerOptions)\n            \u002F\u002F把html注入网页内\n\t\t\t$('.tk-row-actions-start').append(picker)\n        \t\u002F\u002F因为div默认不能使用focus事件，加上tabindex才可以\n\t\t\t$('em-emoji-picker').attr('tabindex','5')\n\t\t\t$('.OwO').show().click(function(){\n\t\t\t\t$('em-emoji-picker').toggle()\n\t\t\t\t$('em-emoji-picker').focus()\n\t\t\t})\n\t\t\t$('em-emoji-picker').blur(function(){\n\t\t\t\t$('em-emoji-picker').toggle()\n\t\t\t})\n\t\t\t\n\t\t}\n\t})\n\t\n&lt;\u002Fscript&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cfigcaption\u003E进行初始化\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"kg-card kg-code-card\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-css\"\u003Eem-emoji-picker{\n    display: none;\n    position: absolute;\n    top: 3rem;\n    z-index: 2;\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cfigcaption\u003E增加一点简单的样式处理\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"kg-card kg-image-card kg-card-hascaption\"\u003E\u003Cimg src=\"https:\u002F\u002Fcdn.1900.live\u002Fassets\u002F2022\u002F09\u002F10image.png\" class=\"kg-image\" alt loading=\"lazy\" width=\"966\" height=\"867\"\u003E\u003Cfigcaption\u003E效果图\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch3 id=\"%E5%BE%85%E5%AE%8C%E5%96%84\"\u003E待完善\u003C\u002Fh3\u003E\u003Cp\u003E因为目前的emoji-mart没办法动态改变主题，所以目前暂时还没有实现主题的联动，希望作者后续能进行改进。\u003C\u002Fp\u003E\u003Ch3 id=\"%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5\"\u003E参考链接\u003C\u002Fh3\u003E\u003Cul\u003E\u003Cli\u003Ediv失去焦点事件 - \u003Ca href=\"https:\u002F\u002Fblog.csdn.net\u002Fvip545058\u002Farticle\u002Fdetails\u002F24296865?ref=1900.live\"\u003Ehttps:\u002F\u002Fblog.csdn.net\u002Fvip545058\u002Farticle\u002Fdetails\u002F24296865\u003C\u002Fa\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E","date":"10 September 2022","path":"replace-twikoos-emoji-selector-with-emoji-mart"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/gridsome-blog/assets/js/app.d87bab28.js" defer></script><script src="/gridsome-blog/assets/js/page--src--templates--ghost-post-vue.a078e51b.js" defer></script>
  </body>
</html>