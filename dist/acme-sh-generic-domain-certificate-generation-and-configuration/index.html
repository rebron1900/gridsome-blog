<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>åªæ˜¯ç©ç© | JUST FUN - åªæ˜¯ç©ç© | JUST FUN</title><meta name="gridsome:hash" content="c172d95f3caedc458b15c41bd34a3ceddae884e7"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="/gridsome-blog"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/assets/css/0.styles.be694e5c.css" as="style"><link rel="preload" href="/assets/js/app.b62e6b44.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--ghost-post-vue.9ef213ea.js" as="script"><link rel="prefetch" href="/assets/js/6.bfbe7afa.js"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.37be74ee.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-copy-vue.a63bb83d.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.32fdddc8.js"><link rel="stylesheet" href="/assets/css/0.styles.be694e5c.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body  class="darkmode">
    <main role="main" data-server-rendered="true" id="app" class="container"><div class="row"><header class="header"><a href="/" class="active"><h1>ğŸ‘¨â€ğŸ’» åªæ˜¯ç©ç© | JUST FUN</h1></a><!----></header><div class="article"><h1 class="article-title">å…¨ç«™HTTPS ã€å®Œã€‘ï¼šacme.shæ³›åŸŸåè¯ä¹¦ç”Ÿæˆå’Œé…ç½®</h1><p class="article-date"> 5 September 2022 Â· <i> min read</i></p><article><p>ç›®å‰å·²ç»å…¨éƒ¨æå¦¥äº†ï¼Œæœ‰äº†æ³›åŸŸåè¯ä¹¦ä¹‹åæˆ‘æŠŠä¹‹å‰æ‰€æœ‰çš„åŸŸåè¯ä¹¦å…¨éƒ¨æ›¿æ¢äº†ä¸€ä¸‹ï¼Œç°åœ¨æ›´æ–¹ä¾¿ç®¡ç†äº†ã€‚</p><hr><p>æ—¢ç„¶è¦å¼€å¯å…¨ç«™HTTPSè‚¯å®šç¦»ä¸å¼€SSLè¯ä¹¦è¿™ä¸ªè¯é¢˜ã€‚</p><p>æˆ‘ä»¥å‰ä¸€ç›´ä½¿ç”¨çš„è…¾è®¯çš„TrustAsiaï¼Œä¹Ÿå°±æ˜¯è¯šä¿¡äºšæ´²çš„è¯ä¹¦ã€‚ä½†æ˜¯è…¾è®¯çš„è¿™ä¸ªè¯ä¹¦æœ‰ä¸ªæ¯›ç—…å°±æ˜¯ä¸æ”¯æŒæ³›åŸŸåï¼ˆä¸èƒ½è¯´ä¸æ”¯æŒï¼Œæ˜¯è¦èŠ±é’±ï¼Œè€Œä¸”æ­»è´µï¼‰ï¼Œè€Œä¸”åªèƒ½ä¸€å¹´ä¸€å¹´ç”³è¯·ã€‚ä¸Šæ¬¡æˆ‘ç¬”è®°æœåŠ¡Triliumçš„è¯ä¹¦è¿‡æœŸäº†å°±è¦é‡æ–°ç”³è¯·å¹¶å†æ¬¡ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šæ›¿æ¢æ‰æ—§çš„è¯ä¹¦ï¼Œé‚£ä¸ªæ—¶å€™è§‰çš„è¶…çº§éº»çƒ¦ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä¸€ç›´æ²¡å¼„HTTPSçš„ä¸»è¦åŸå› ã€‚</p><p>è¿™æ¬¡åœ¨ç»™åˆæ‹äº‘å¼„SSLè¯ä¹¦çš„æ—¶å€™å¿½ç„¶å°±æƒ³ç€è¦ä¸è¦æŸ¥æŸ¥çœ‹æœ‰æ²¡æœ‰å…è´¹çš„æ³›åŸŸåè¯ä¹¦ç”¨ï¼Œè¿™ä¸€æœæœç„¶æœ‰â€”â€” <code>acme.sh</code> ï¼Œä»–å¯ä»¥æ”¯æŒè‡ªåŠ¨åŒ–çš„ä»Letâ€™s Encryptè·å–å…è´¹çš„æ³›åŸŸåè¯ä¹¦ï¼Œè€Œä¸”è¿˜æ”¯æŒè‡ªåŠ¨æ›´æ–°ã€‚æˆ‘ä¹‹å‰æœ‰ä¸€æ¬¡æƒ³ç»™Ghoståšå®¢æå…¨ç«™HTTPSæ—¶è¿˜ç”¨è¿‡è¿™ä¸ªæœåŠ¡ï¼Œå½“æ—¶Ghostæ”¯æŒä¸€é”®è°ƒç”¨acme.shç”Ÿæˆè¯ä¹¦å¹¶å¯ç”¨HTTPSï¼Œä¸è¿‡å½“æ—¶æ²¡ç ”ç©¶è¿™ä¸ªä¸œè¥¿æ‰€ä»¥ä¸å¤ªæ‡‚ï¼Œåæ¥å‡ºäº†äº›é…ç½®é—®é¢˜å¼„ä¸æ‡‚æˆ‘ä¹Ÿå°±å¼ƒç”¨äº†ã€‚</p><h3 id="acmesh%E4%BB%8B%E7%BB%8D">acme.shä»‹ç»</h3><p>acme.shæ˜¯ä¸ªå¼€æºçš„shellè¯ä¹¦ç”Ÿæˆè„šæœ¬ï¼Œä»–å¯ä»¥è‡ªåŠ¨ç”ŸæˆLetâ€™s Encryptçš„è¯ä¹¦ï¼Œè€ŒLetâ€™s Encrypt æ˜¯ä¸€å®¶å…è´¹ã€å¼€æ”¾ã€è‡ªåŠ¨åŒ–çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ï¼Œä¸ºå…¬ä¼—çš„åˆ©ç›Šè€Œè¿è¡Œã€‚å®ƒæ˜¯ä¸€é¡¹ç”± <a href="https://www.abetterinternet.org/?ref=1900.live">Internet Security Research Groupï¼ˆISRGï¼‰</a>æä¾›çš„æœåŠ¡ã€‚æˆ‘ä»¬ä»¥å°½å¯èƒ½å¯¹ç”¨æˆ·å‹å¥½çš„æ–¹å¼å…è´¹æä¾›ä¸ºç½‘ç«™å¯ç”¨ HTTPSï¼ˆSSL/TLSï¼‰æ‰€éœ€çš„æ•°å­—è¯ä¹¦ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªæ›´å®‰å…¨ï¼Œæ›´å°Šé‡éšç§çš„ Web ç¯å¢ƒã€‚</p><div class="kg-card kg-callout-card kg-callout-card-grey"><div class="kg-callout-emoji">ğŸ’¡</div><div class="kg-callout-text">It's probably the <code>easiest &amp; smartest</code> shell script to automatically issue &amp; renew the free certificates.<br>è¿™å¯èƒ½æ˜¯æœ€ç®€å•å’Œæœ€æ™ºèƒ½çš„ shell è„šæœ¬è‡ªåŠ¨å‘å¸ƒå’Œæ›´æ–°å…è´¹è¯ä¹¦ã€‚</div></div><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://github.com/acmesh-official/acme.sh?ref=1900.live"><div class="kg-bookmark-content"><div class="kg-bookmark-title">GitHub - acmesh-official/acme.sh: A pure Unix shell script implementing ACME client protocol</div><div class="kg-bookmark-description">A pure Unix shell script implementing ACME client protocol - GitHub - acmesh-official/acme.sh: A pure Unix shell script implementing ACME client protocol</div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://github.com/fluidicon.png" alt><span class="kg-bookmark-author">GitHub</span><span class="kg-bookmark-publisher">acmesh-official</span></div></div><div class="kg-bookmark-thumbnail"><img src="https://opengraph.githubassets.com/af7983db8bd3b13c94953f49c6d91c434b9b0bbc28f56ec757f974dcdc53f411/acmesh-official/acme.sh" alt></div></a></figure><h3 id="%E5%AE%89%E8%A3%85">å®‰è£…</h3><p>æˆ‘æ ¹æ®acme.shçš„githubä¸Šçš„ä¸­æ–‡è¯´æ˜å®‰è£…å¥½äº†è¿™ä¸ªè¯ä¹¦ï¼Œä¸è¿‡æœ€å¼€å§‹æˆ‘çœ‹çš„æ˜¯ç½‘ç»œä¸Šçš„å…¶ä»–æ•™ç¨‹è¸©äº†ä¸å°‘å‘ï¼Œå¾ˆå¤šæ•™ç¨‹è¦ä¸å°±æ˜¯å¤ªè€ï¼Œè¦ä¸å°±æ˜¯å„ç§ç¨€å¥‡å¤æ€ªçš„åŸå› æ— æ³•æ­£å¸¸å®‰è£…ã€‚</p><p>é¦–å…ˆéœ€è¦å®‰è£…acme.shã€‚æˆ‘ä»¬åªéœ€è¦æ‰§è¡Œå¾ˆç®€å•çš„ä¸€è¡Œå‘½ä»¤å³å¯å®‰è£…è¯¥è„šæœ¬ã€‚ä¸è¿‡ä½¿ç”¨å›½å†…çš„è…¾è®¯è½»é‡äº‘æœåŠ¡å™¨å®‰è£…æ—¶ä¼šåœ¨å®‰è£…è¿‡ç¨‹ä¸­ç»å¸¸å¡ä½ï¼Œæˆ‘çœ‹äº†ä¸€ä¸‹shè„šæœ¬å¥½åƒè¦è¯·æ±‚Githubçš„æœåŠ¡å™¨ï¼Œä½†æ˜¯å›½å†…ä¸æŒ‚æ¢¯å­è®¿é—®Githubä¼šå¾ˆæ…¢ã€‚æ‰€ä»¥æˆ‘æ¯æ¬¡å¡ä½å°±ç›´æ¥ç»“æŸå‘½ä»¤é‡æ–°å†æ‰§è¡Œä¸€æ¬¡ï¼Œç›´åˆ°é¡ºç•…æ‰§è¡ŒæˆåŠŸä¸ºæ­¢ï¼ˆåæ­£å°±æ˜¯ç¢°è¿æ°”ã€‚ï¼‰</p><figure class="kg-card kg-code-card"><pre><code>curl  https://get.acme.sh | sh -s email=my@example.com
</code></pre><figcaption>ubuntuæ‰§è¡Œä»¥ä¸Šå‘½ä»¤å®‰è£…</figcaption></figure><p>è¿™ä¸ªå‘½ä»¤ä¼šæŠŠ <code>acme.sh</code> å®‰è£…åˆ°ä½ çš„ç”¨æˆ·ç›®å½•ä¸‹ï¼Œå¹¶è®¾ä¸ºéšè—ï¼Œä½ å¯ä»¥åœ¨å®‰è£…å®Œæˆä¹‹åé€šè¿‡ <code>ls -a</code> æ¥æ£€æŸ¥æ˜¯å¦æœ‰åä¸º <code>.acme.sh</code> ç›®å½•ã€‚</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://cdn.1900.live/assets/2022/09/05image.png" class="kg-image" alt loading="lazy" width="850" height="451"><figcaption>å®‰è£…æˆåŠŸï¼Œå¹¶è‡ªåŠ¨è®¾ç½®äº†cron job</figcaption></figure><p>åœ¨å®‰è£…å®Œæˆä¹‹åä½ å¯èƒ½éœ€è¦æ‰§è¡Œ <code>alias acme.sh=~/.acme.sh/acme.sh</code> åˆ›å»º ä¸€ä¸ª bash çš„ aliasï¼Œæˆ‘å®‰è£…çš„æ—¶å€™çœ‹çš„å¦å¤–ä¸€ä¸ªæ•™ç¨‹æ²¡æœ‰è¯´è¿™ä¸€éƒ¨ï¼Œå¯¼è‡´ä¸€ç›´æç¤º <code>acme.sh: command not found</code> ï¼Œæ— æ³•æ‰§è¡Œacme.shå‘½ä»¤ï¼Œå¡äº†æˆ‘å¥½å‡ ä¸ªå°æ—¶ã€‚</p><h3 id="%E8%AE%A4%E8%AF%81">è®¤è¯</h3><p>å®˜æ–¹æä¾›çš„è¯ä¹¦è®¤è¯æ–¹å¼æœ‰ä¸‰ç§</p><ul><li>http æ–¹å¼éœ€è¦åœ¨ä½ çš„ç½‘ç«™æ ¹ç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ªæ–‡ä»¶, æ¥éªŒè¯ä½ çš„åŸŸåæ‰€æœ‰æƒ,å®ŒæˆéªŒè¯. ç„¶åå°±å¯ä»¥ç”Ÿæˆè¯ä¹¦äº†</li><li>æ‰‹åŠ¨ dns æ–¹å¼, æ‰‹åŠ¨åœ¨åŸŸåä¸Šæ·»åŠ ä¸€æ¡ txt è§£æè®°å½•, éªŒè¯åŸŸåæ‰€æœ‰æƒ.</li><li>å¯ä»¥ä½¿ç”¨åŸŸåè§£æå•†æä¾›çš„ api è‡ªåŠ¨æ·»åŠ  txt è®°å½•å®ŒæˆéªŒè¯.</li></ul><p>å‰é¢ä¸¤ç§éƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘å°±ç›´æ¥ä½¿ç”¨äº†ç¬¬ä¸‰ç§ï¼šåˆ©ç”¨åŸŸåè§£æå•†æä¾›çš„APIè®©acme.shè‡ªåŠ¨è¿›è¡Œç›¸å…³çš„éªŒè¯æ“ä½œã€‚acme.shç›®å‰æ”¯æŒ cloudflare, dnspod, cloudxns, godaddy ä»¥åŠ ovh ç­‰æ•°åç§è§£æå•†çš„è‡ªåŠ¨é›†æˆã€‚</p><h4 id="%E8%8E%B7%E5%8F%96dns%E6%9C%8D%E5%8A%A1%E5%95%86token">è·å–DNSæœåŠ¡å•†token</h4><p>æˆ‘ç”¨çš„æ˜¯DNSPodï¼Œæ‰€ä»¥è¿™é‡Œå°±è¯¦ç»†è¯´ä¸‹DNSPodæ€ä¹ˆè·å–tokenã€‚</p><ul><li>ç™»å½•DNSPodåå°</li><li>ç‚¹å‡»å³ä¸Šè§’è‡ªå·±çš„å¤´åƒ</li><li>ç‚¹å‡»å·¦ä¾§é€‰é¡¹å¡ä¼¤çš„çš„ <code>DNSPod Tokens</code></li><li>ç‚¹å‡» <code>åˆ›å»ºå¯†é’¥</code> åèµ·ä¸ªåå­—ï¼Œæ¥ç€å°±èƒ½æ‹¿åˆ°IDå’Œtokenå€¼ï¼Œå¦å¤–æ³¨æ„ï¼ŒTokenå€¼åªæ˜¾ç¤ºä¸€æ¬¡ï¼Œè¯·è®°å¥½å¤‡ä»½ã€‚</li></ul><figure class="kg-card kg-gallery-card kg-width-wide"><div class="kg-gallery-container"><div class="kg-gallery-row"><div class="kg-gallery-image"><img src="https://cdn.1900.live/assets/2022/09/05Snipaste_2022-09-05_23-00-09.jpg" width="632" height="460" loading="lazy" alt></div><div class="kg-gallery-image"><img src="https://cdn.1900.live/assets/2022/09/05Snipaste_2022-09-05_23-00-35.jpg" width="1618" height="695" loading="lazy" alt></div></div></div></figure><h4 id="%E8%AE%BE%E7%BD%AEdnspod-token">è®¾ç½®DNSPod token</h4><p>é€šè¿‡åœ¨å‘½ä»¤è¡Œé‡Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤è®¾ç½®tokenï¼Œè¦ä¸¥æ ¼æŒ‰æ ¼å¼æ¥ï¼Œ <code>DP_Id</code> åçš„ <code>=</code> å·å‰åä¸èƒ½æœ‰ç©ºæ ¼ã€‚ <code>DP_Id</code> ä¸ºDNSPodé‡Œç”Ÿæˆçš„ <code>id</code> ï¼Œ <code>DP_Key</code> ä¸ºç”Ÿæˆçš„ <code>token</code> </p><pre><code class="language-bash">export DP_Id=""
export DP_Key=""</code></pre><h4 id="%E7%94%9F%E6%88%90">ç”Ÿæˆ</h4><p>ç”Ÿæˆè¯ä¹¦ï¼Œè¿™é‡Œä¸€å®šè¦å…ˆæ·»åŠ ä¸»åŸŸåï¼Œå†æ·»åŠ æ³›åŸŸåã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>-d</code> æ¥æ·»åŠ å¤šä¸ªåŸŸåã€‚åŸŸåç”Ÿæˆåè¯ä¹¦æ–‡ä»¶ä¼šè‡ªåŠ¨å­˜æ”¾åœ¨ <code>.acme.sh</code> ç›®å½•é‡Œï¼Œæ–‡ä»¶å¤¹åç§°ä¸ºä½ æ·»åŠ çš„ä¸»åŸŸåã€‚</p><pre><code class="language-bash">acme.sh   --issue   --dns dns_dp   -d aa.com  -d *.aa.com</code></pre><h3 id="%E5%AE%89%E8%A3%85%E8%AF%81%E4%B9%A6%E5%88%B0%E6%8C%87%E5%AE%9A%E7%9B%AE%E5%BD%95">å®‰è£…è¯ä¹¦åˆ°æŒ‡å®šç›®å½•</h3><p>å› ä¸ºæˆ‘ç”¨çš„Nginxï¼Œæ‰€ä»¥è¿™é‡Œè¯´ä¸€ä¸‹æ€ä¹ˆå®‰è£…åˆ°Nginxé‡Œã€‚</p><p>æˆ‘ä¹‹å‰çœ‹çš„æ•™ç¨‹æ˜¯ç›´æ¥cpè¯ä¹¦åˆ°nginxè¯ä¹¦ç›®å½•é‡Œï¼Œä½†æ˜¯çœ‹äº†å®˜æ–¹çš„è¯´æ˜å’Œå…¶ä»–ä¸€äº›ç½‘å‹åˆ†äº«çš„ç»éªŒæ‰çŸ¥é“æœ€å¥½æ˜¯é€šè¿‡å‘½ä»¤æ¥å®‰è£…è¯ä¹¦æ–‡ä»¶ã€‚</p><div class="kg-card kg-callout-card kg-callout-card-red"><div class="kg-callout-emoji">ğŸ’¡</div><div class="kg-callout-text">æ³¨æ„, é»˜è®¤ç”Ÿæˆçš„è¯ä¹¦éƒ½æ”¾åœ¨å®‰è£…ç›®å½•ä¸‹: <code>~/.acme.sh/</code>, è¯·ä¸è¦ç›´æ¥ä½¿ç”¨æ­¤ç›®å½•ä¸‹çš„æ–‡ä»¶, ä¾‹å¦‚: ä¸è¦ç›´æ¥è®© nginx/apache çš„é…ç½®æ–‡ä»¶ä½¿ç”¨è¿™ä¸‹é¢çš„æ–‡ä»¶. è¿™é‡Œé¢çš„æ–‡ä»¶éƒ½æ˜¯å†…éƒ¨ä½¿ç”¨, è€Œä¸”ç›®å½•ç»“æ„å¯èƒ½ä¼šå˜åŒ–.</div></div><p>æˆ‘ä»¬éœ€è¦é€šè¿‡ <code>--install-cert</code> æ¥å®‰è£…è¯ä¹¦æ–‡ä»¶ï¼Œä½¿ç”¨å®˜æ–¹çš„è¿™ç§æ–¹å¼ä»¥åå¯ä»¥è‡ªåŠ¨æ— æ„Ÿç»­æœŸã€è‡ªåŠ¨æ›´æ–°ç­‰ã€‚å®˜æ–¹å®‰è£…è¯´æ˜reloadcmdä½¿ç”¨çš„æ˜¯ï¼š Â <code>service nginx force-reload</code> ï¼Œæˆ‘ç”¨çš„ä¸‹é¢çš„ï¼Œä¸çŸ¥é“ä¼šä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€‚ </p><figure class="kg-card kg-code-card"><pre><code class="language-bash">acme.sh --install-cert -d example.com \
--key-file       /youdata/ssl/nginx/yourdomain.key  \
--fullchain-file /youdata/ssl/nginx/fullchain.cer \
--reloadcmd     "sudo nginx -s reload"</code></pre><figcaption>å®‰è£…è¯ä¹¦æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶è®¾ç½®é‡è½½å‘½ä»¤</figcaption></figure><p>è¿™æ ·åœ¨æŒ‡å®šç›®å½•ä¼šè‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„è¯ä¹¦æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åœ¨Nginxé…ç½®æ–‡ä»¶é‡Œè¿›è¡Œå¼•ç”¨å°±è¡Œäº†ã€‚</p><h4 id="%E7%BB%AD%E6%9C%9F">ç»­æœŸ</h4><p>æˆ‘ä»¬å‰é¢åœ¨å®‰è£…acme.shçš„æ—¶å€™é»˜è®¤ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª <code>crontab</code> ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>crontab -l</code> æŸ¥çœ‹ã€‚é»˜è®¤çš„è®¡åˆ’ä»»åŠ¡æ˜¯æ¯å¤©æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦éœ€è¦ç»­æœŸï¼Œå¦‚æœéœ€è¦åˆ™ä¼šè‡ªåŠ¨ç»­æœŸï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªç”±è®¾ç½®ä»»åŠ¡ï¼Œcrontabç¤ºä¾‹é…ç½®å¦‚ä¸‹ï¼š</p><pre><code>56 * * * * "/root/.acme.sh"/acme.sh --cron --home "/root/.acme.sh" &gt; /dev/null</code></pre><h4 id="nginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">Nginxé…ç½®æ–‡ä»¶</h4><p>æˆ‘ä»¥å‰æ²¡æœ‰ç”¨ä»£ç ç‰‡æ®µæ¥ç®¡ç†sslè¯ä¹¦ï¼Œä¹Ÿä¸æ‡‚è¦æ€ä¹ˆå¼„ï¼Œè¿™æ¬¡åœ¨ <a href="https://learnku.com/articles/13496/lets-encrypt-pan-domain-name-application-and-configuration?ref=1900.live">è¿™ç¯‡æ–‡ç« é‡Œ</a> è§£é”äº†ä»£ç æ®µçš„ä½¿ç”¨ï¼ˆä½†æ˜¯è¿™ç¯‡æ–‡ç« çš„å…¶ä»–éƒ¨åˆ†éƒ½æ˜¯å‘ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ¯”è¾ƒè€çš„ç¼˜æ•…ï¼Œ4å¹´å‰çš„æ–‡ç« äº†ï¼‰</p><p>å…ˆåœ¨ <code>/etc/nginx/snippets</code> ç›®å½•ä¸‹åˆ›å»ºä»£ç æ®µæ–‡ä»¶ <code>ssl-params.conf</code> ä¸“é—¨æ‹¿æ¥é…ç½®SSLç›¸å…³çš„è®¾ç½®ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œç”¨çš„ä¹Ÿæ˜¯ä¸Šé¢é‚£ä½ä½œè€…çš„è®¾ç½®ï¼Œä¸çŸ¥é“4å¹´å‰çš„ä¸œè¥¿ç°åœ¨æ˜¯ä¸æ˜¯è¦æ”¹ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰çœ‹åˆ°è¿™é‡Œçš„å¤§ä½¬éº»çƒ¦æŒ‡ç‚¹ä¸€ä¸‹ã€‚</p><pre><code class="language-nginx"># /etc/nginx/snippets/ssl-params.conf

server_tokens   off;

ssl_session_cache        shared:SSL:10m;
ssl_session_timeout      60m;

ssl_session_tickets      on;

ssl_stapling             on;
ssl_stapling_verify      on;

resolver                 8.8.4.4 8.8.8.8  valid=300s;
resolver_timeout         10s;
ssl_prefer_server_ciphers on;

# è¯ä¹¦è·¯å¾„ ç»å¯¹åœ°å€
ssl_certificate          /youdata/ssl/nginx/fullchain.cer;
ssl_certificate_key      /youdata/ssl/nginx/yourdomain.key;

ssl_protocols            TLSv1 TLSv1.1 TLSv1.2;

ssl_ciphers "EECDH+AESGCM:EDH+AESGCM:ECDHE-RSA-AES128-GCM-SHA256:AES256+EECDH:DHE-RSA-AES128-GCM-SHA256:AES256+EDH:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES128-SHA256:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:AES128-SHA:DES-CBC3-SHA:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!MD5:!PSK:!RC4";

add_header Strict-Transport-Security "max-age=31536000;includeSubDomains;preload";
add_header  X-Frame-Options  deny;
add_header  X-Content-Type-Options  nosniff;
add_header x-xss-protection "1; mode=block";
add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' blob: https:; connect-src 'self' https:; img-src 'self' data: https: blob:; style-src 'unsafe-inline' https:; font-src https:";</code></pre><p>æ¥ä¸‹æ¥å†æ–°å»ºä¸€ä¸ªnginxé…ç½®æ–‡ä»¶ï¼Œå¹¶é…ç½®serveré¡¹ï¼Œå¹¶åœ¨serveré¡¹é‡Œé€šè¿‡ <code>include</code> å‘½ä»¤å¯¼å…¥æˆ‘ä»¬ä¹‹å‰å†™çš„sslé…ç½®ä»£ç æ®µå³å¯ã€‚</p><pre><code>server {
    listen 443 ssl;
    server_name test.yourdomain.com;
    
    include snippets/ssl-params.conf;

  location / {
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto $scheme;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header Host $http_host;
      proxy_pass http://127.0.0.1:15215;

      # å¦‚æœæ‚¨è¦ä½¿ç”¨æœ¬åœ°å­˜å‚¨ç­–ç•¥ï¼Œè¯·å°†ä¸‹ä¸€è¡Œæ³¨é‡Šç¬¦åˆ é™¤ï¼Œå¹¶æ›´æ”¹å¤§å°ä¸ºç†è®ºæœ€å¤§æ–‡ä»¶å°ºå¯¸
      # client_max_body_size 20000m;
  }


    location ~ /.well-known {
        allow all;
    }

    client_max_body_size 50m;
}


</code></pre></article></div><div class="footer"><div><p>
          Built with
          <a target="_blank" href="//gridsome.org" class="link">Gridsome</a>
          &amp; Made with â¤ï¸ by
          <a target="_blank" href="//alex.design" class="link">Alex Brown</a></p></div><div class="footer-links"><a target="_blank" href="/sitemap.xml">Sitemap</a><a target="_blank" href="/feed.xml">RSS Feed</a></div></div></div></main>
    <script>window.__INITIAL_STATE__={"data":{"metadata":{"siteName":"åªæ˜¯ç©ç© | JUST FUN","siteDescription":"\u002Fgridsome-blog"},"post":{"id":"631606e5f34995641ae85f35","title":"å…¨ç«™HTTPS ã€å®Œã€‘ï¼šacme.shæ³›åŸŸåè¯ä¹¦ç”Ÿæˆå’Œé…ç½®","content":"\u003Cp\u003Eç›®å‰å·²ç»å…¨éƒ¨æå¦¥äº†ï¼Œæœ‰äº†æ³›åŸŸåè¯ä¹¦ä¹‹åæˆ‘æŠŠä¹‹å‰æ‰€æœ‰çš„åŸŸåè¯ä¹¦å…¨éƒ¨æ›¿æ¢äº†ä¸€ä¸‹ï¼Œç°åœ¨æ›´æ–¹ä¾¿ç®¡ç†äº†ã€‚\u003C\u002Fp\u003E\u003Chr\u003E\u003Cp\u003Eæ—¢ç„¶è¦å¼€å¯å…¨ç«™HTTPSè‚¯å®šç¦»ä¸å¼€SSLè¯ä¹¦è¿™ä¸ªè¯é¢˜ã€‚\u003C\u002Fp\u003E\u003Cp\u003Eæˆ‘ä»¥å‰ä¸€ç›´ä½¿ç”¨çš„è…¾è®¯çš„TrustAsiaï¼Œä¹Ÿå°±æ˜¯è¯šä¿¡äºšæ´²çš„è¯ä¹¦ã€‚ä½†æ˜¯è…¾è®¯çš„è¿™ä¸ªè¯ä¹¦æœ‰ä¸ªæ¯›ç—…å°±æ˜¯ä¸æ”¯æŒæ³›åŸŸåï¼ˆä¸èƒ½è¯´ä¸æ”¯æŒï¼Œæ˜¯è¦èŠ±é’±ï¼Œè€Œä¸”æ­»è´µï¼‰ï¼Œè€Œä¸”åªèƒ½ä¸€å¹´ä¸€å¹´ç”³è¯·ã€‚ä¸Šæ¬¡æˆ‘ç¬”è®°æœåŠ¡Triliumçš„è¯ä¹¦è¿‡æœŸäº†å°±è¦é‡æ–°ç”³è¯·å¹¶å†æ¬¡ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šæ›¿æ¢æ‰æ—§çš„è¯ä¹¦ï¼Œé‚£ä¸ªæ—¶å€™è§‰çš„è¶…çº§éº»çƒ¦ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä¸€ç›´æ²¡å¼„HTTPSçš„ä¸»è¦åŸå› ã€‚\u003C\u002Fp\u003E\u003Cp\u003Eè¿™æ¬¡åœ¨ç»™åˆæ‹äº‘å¼„SSLè¯ä¹¦çš„æ—¶å€™å¿½ç„¶å°±æƒ³ç€è¦ä¸è¦æŸ¥æŸ¥çœ‹æœ‰æ²¡æœ‰å…è´¹çš„æ³›åŸŸåè¯ä¹¦ç”¨ï¼Œè¿™ä¸€æœæœç„¶æœ‰â€”â€” \u003Ccode\u003Eacme.sh\u003C\u002Fcode\u003E ï¼Œä»–å¯ä»¥æ”¯æŒè‡ªåŠ¨åŒ–çš„ä»Letâ€™s Encryptè·å–å…è´¹çš„æ³›åŸŸåè¯ä¹¦ï¼Œè€Œä¸”è¿˜æ”¯æŒè‡ªåŠ¨æ›´æ–°ã€‚æˆ‘ä¹‹å‰æœ‰ä¸€æ¬¡æƒ³ç»™Ghoståšå®¢æå…¨ç«™HTTPSæ—¶è¿˜ç”¨è¿‡è¿™ä¸ªæœåŠ¡ï¼Œå½“æ—¶Ghostæ”¯æŒä¸€é”®è°ƒç”¨acme.shç”Ÿæˆè¯ä¹¦å¹¶å¯ç”¨HTTPSï¼Œä¸è¿‡å½“æ—¶æ²¡ç ”ç©¶è¿™ä¸ªä¸œè¥¿æ‰€ä»¥ä¸å¤ªæ‡‚ï¼Œåæ¥å‡ºäº†äº›é…ç½®é—®é¢˜å¼„ä¸æ‡‚æˆ‘ä¹Ÿå°±å¼ƒç”¨äº†ã€‚\u003C\u002Fp\u003E\u003Ch3 id=\"acmesh%E4%BB%8B%E7%BB%8D\"\u003Eacme.shä»‹ç»\u003C\u002Fh3\u003E\u003Cp\u003Eacme.shæ˜¯ä¸ªå¼€æºçš„shellè¯ä¹¦ç”Ÿæˆè„šæœ¬ï¼Œä»–å¯ä»¥è‡ªåŠ¨ç”ŸæˆLetâ€™s Encryptçš„è¯ä¹¦ï¼Œè€ŒLetâ€™s Encrypt æ˜¯ä¸€å®¶å…è´¹ã€å¼€æ”¾ã€è‡ªåŠ¨åŒ–çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ï¼Œä¸ºå…¬ä¼—çš„åˆ©ç›Šè€Œè¿è¡Œã€‚å®ƒæ˜¯ä¸€é¡¹ç”± \u003Ca href=\"https:\u002F\u002Fwww.abetterinternet.org\u002F?ref=1900.live\"\u003EInternet Security Research Groupï¼ˆISRGï¼‰\u003C\u002Fa\u003Eæä¾›çš„æœåŠ¡ã€‚æˆ‘ä»¬ä»¥å°½å¯èƒ½å¯¹ç”¨æˆ·å‹å¥½çš„æ–¹å¼å…è´¹æä¾›ä¸ºç½‘ç«™å¯ç”¨ HTTPSï¼ˆSSL\u002FTLSï¼‰æ‰€éœ€çš„æ•°å­—è¯ä¹¦ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªæ›´å®‰å…¨ï¼Œæ›´å°Šé‡éšç§çš„ Web ç¯å¢ƒã€‚\u003C\u002Fp\u003E\u003Cdiv class=\"kg-card kg-callout-card kg-callout-card-grey\"\u003E\u003Cdiv class=\"kg-callout-emoji\"\u003EğŸ’¡\u003C\u002Fdiv\u003E\u003Cdiv class=\"kg-callout-text\"\u003EIt's probably the \u003Ccode\u003Eeasiest &amp; smartest\u003C\u002Fcode\u003E shell script to automatically issue &amp; renew the free certificates.\u003Cbr\u003Eè¿™å¯èƒ½æ˜¯æœ€ç®€å•å’Œæœ€æ™ºèƒ½çš„ shell è„šæœ¬è‡ªåŠ¨å‘å¸ƒå’Œæ›´æ–°å…è´¹è¯ä¹¦ã€‚\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cfigure class=\"kg-card kg-bookmark-card\"\u003E\u003Ca class=\"kg-bookmark-container\" href=\"https:\u002F\u002Fgithub.com\u002Facmesh-official\u002Facme.sh?ref=1900.live\"\u003E\u003Cdiv class=\"kg-bookmark-content\"\u003E\u003Cdiv class=\"kg-bookmark-title\"\u003EGitHub - acmesh-official\u002Facme.sh: A pure Unix shell script implementing ACME client protocol\u003C\u002Fdiv\u003E\u003Cdiv class=\"kg-bookmark-description\"\u003EA pure Unix shell script implementing ACME client protocol - GitHub - acmesh-official\u002Facme.sh: A pure Unix shell script implementing ACME client protocol\u003C\u002Fdiv\u003E\u003Cdiv class=\"kg-bookmark-metadata\"\u003E\u003Cimg class=\"kg-bookmark-icon\" src=\"https:\u002F\u002Fgithub.com\u002Ffluidicon.png\" alt\u003E\u003Cspan class=\"kg-bookmark-author\"\u003EGitHub\u003C\u002Fspan\u003E\u003Cspan class=\"kg-bookmark-publisher\"\u003Eacmesh-official\u003C\u002Fspan\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"kg-bookmark-thumbnail\"\u003E\u003Cimg src=\"https:\u002F\u002Fopengraph.githubassets.com\u002Faf7983db8bd3b13c94953f49c6d91c434b9b0bbc28f56ec757f974dcdc53f411\u002Facmesh-official\u002Facme.sh\" alt\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003C\u002Ffigure\u003E\u003Ch3 id=\"%E5%AE%89%E8%A3%85\"\u003Eå®‰è£…\u003C\u002Fh3\u003E\u003Cp\u003Eæˆ‘æ ¹æ®acme.shçš„githubä¸Šçš„ä¸­æ–‡è¯´æ˜å®‰è£…å¥½äº†è¿™ä¸ªè¯ä¹¦ï¼Œä¸è¿‡æœ€å¼€å§‹æˆ‘çœ‹çš„æ˜¯ç½‘ç»œä¸Šçš„å…¶ä»–æ•™ç¨‹è¸©äº†ä¸å°‘å‘ï¼Œå¾ˆå¤šæ•™ç¨‹è¦ä¸å°±æ˜¯å¤ªè€ï¼Œè¦ä¸å°±æ˜¯å„ç§ç¨€å¥‡å¤æ€ªçš„åŸå› æ— æ³•æ­£å¸¸å®‰è£…ã€‚\u003C\u002Fp\u003E\u003Cp\u003Eé¦–å…ˆéœ€è¦å®‰è£…acme.shã€‚æˆ‘ä»¬åªéœ€è¦æ‰§è¡Œå¾ˆç®€å•çš„ä¸€è¡Œå‘½ä»¤å³å¯å®‰è£…è¯¥è„šæœ¬ã€‚ä¸è¿‡ä½¿ç”¨å›½å†…çš„è…¾è®¯è½»é‡äº‘æœåŠ¡å™¨å®‰è£…æ—¶ä¼šåœ¨å®‰è£…è¿‡ç¨‹ä¸­ç»å¸¸å¡ä½ï¼Œæˆ‘çœ‹äº†ä¸€ä¸‹shè„šæœ¬å¥½åƒè¦è¯·æ±‚Githubçš„æœåŠ¡å™¨ï¼Œä½†æ˜¯å›½å†…ä¸æŒ‚æ¢¯å­è®¿é—®Githubä¼šå¾ˆæ…¢ã€‚æ‰€ä»¥æˆ‘æ¯æ¬¡å¡ä½å°±ç›´æ¥ç»“æŸå‘½ä»¤é‡æ–°å†æ‰§è¡Œä¸€æ¬¡ï¼Œç›´åˆ°é¡ºç•…æ‰§è¡ŒæˆåŠŸä¸ºæ­¢ï¼ˆåæ­£å°±æ˜¯ç¢°è¿æ°”ã€‚ï¼‰\u003C\u002Fp\u003E\u003Cfigure class=\"kg-card kg-code-card\"\u003E\u003Cpre\u003E\u003Ccode\u003Ecurl  https:\u002F\u002Fget.acme.sh | sh -s email=my@example.com\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cfigcaption\u003Eubuntuæ‰§è¡Œä»¥ä¸Šå‘½ä»¤å®‰è£…\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003Eè¿™ä¸ªå‘½ä»¤ä¼šæŠŠ \u003Ccode\u003Eacme.sh\u003C\u002Fcode\u003E å®‰è£…åˆ°ä½ çš„ç”¨æˆ·ç›®å½•ä¸‹ï¼Œå¹¶è®¾ä¸ºéšè—ï¼Œä½ å¯ä»¥åœ¨å®‰è£…å®Œæˆä¹‹åé€šè¿‡ \u003Ccode\u003Els -a\u003C\u002Fcode\u003E æ¥æ£€æŸ¥æ˜¯å¦æœ‰åä¸º \u003Ccode\u003E.acme.sh\u003C\u002Fcode\u003E ç›®å½•ã€‚\u003C\u002Fp\u003E\u003Cfigure class=\"kg-card kg-image-card kg-card-hascaption\"\u003E\u003Cimg src=\"https:\u002F\u002Fcdn.1900.live\u002Fassets\u002F2022\u002F09\u002F05image.png\" class=\"kg-image\" alt loading=\"lazy\" width=\"850\" height=\"451\"\u003E\u003Cfigcaption\u003Eå®‰è£…æˆåŠŸï¼Œå¹¶è‡ªåŠ¨è®¾ç½®äº†cron job\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003Eåœ¨å®‰è£…å®Œæˆä¹‹åä½ å¯èƒ½éœ€è¦æ‰§è¡Œ \u003Ccode\u003Ealias acme.sh=~\u002F.acme.sh\u002Facme.sh\u003C\u002Fcode\u003E åˆ›å»º ä¸€ä¸ª bash çš„ aliasï¼Œæˆ‘å®‰è£…çš„æ—¶å€™çœ‹çš„å¦å¤–ä¸€ä¸ªæ•™ç¨‹æ²¡æœ‰è¯´è¿™ä¸€éƒ¨ï¼Œå¯¼è‡´ä¸€ç›´æç¤º \u003Ccode\u003Eacme.sh: command not found\u003C\u002Fcode\u003E ï¼Œæ— æ³•æ‰§è¡Œacme.shå‘½ä»¤ï¼Œå¡äº†æˆ‘å¥½å‡ ä¸ªå°æ—¶ã€‚\u003C\u002Fp\u003E\u003Ch3 id=\"%E8%AE%A4%E8%AF%81\"\u003Eè®¤è¯\u003C\u002Fh3\u003E\u003Cp\u003Eå®˜æ–¹æä¾›çš„è¯ä¹¦è®¤è¯æ–¹å¼æœ‰ä¸‰ç§\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003Ehttp æ–¹å¼éœ€è¦åœ¨ä½ çš„ç½‘ç«™æ ¹ç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ªæ–‡ä»¶, æ¥éªŒè¯ä½ çš„åŸŸåæ‰€æœ‰æƒ,å®ŒæˆéªŒè¯. ç„¶åå°±å¯ä»¥ç”Ÿæˆè¯ä¹¦äº†\u003C\u002Fli\u003E\u003Cli\u003Eæ‰‹åŠ¨ dns æ–¹å¼, æ‰‹åŠ¨åœ¨åŸŸåä¸Šæ·»åŠ ä¸€æ¡ txt è§£æè®°å½•, éªŒè¯åŸŸåæ‰€æœ‰æƒ.\u003C\u002Fli\u003E\u003Cli\u003Eå¯ä»¥ä½¿ç”¨åŸŸåè§£æå•†æä¾›çš„ api è‡ªåŠ¨æ·»åŠ  txt è®°å½•å®ŒæˆéªŒè¯.\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003Eå‰é¢ä¸¤ç§éƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘å°±ç›´æ¥ä½¿ç”¨äº†ç¬¬ä¸‰ç§ï¼šåˆ©ç”¨åŸŸåè§£æå•†æä¾›çš„APIè®©acme.shè‡ªåŠ¨è¿›è¡Œç›¸å…³çš„éªŒè¯æ“ä½œã€‚acme.shç›®å‰æ”¯æŒ cloudflare, dnspod, cloudxns, godaddy ä»¥åŠ ovh ç­‰æ•°åç§è§£æå•†çš„è‡ªåŠ¨é›†æˆã€‚\u003C\u002Fp\u003E\u003Ch4 id=\"%E8%8E%B7%E5%8F%96dns%E6%9C%8D%E5%8A%A1%E5%95%86token\"\u003Eè·å–DNSæœåŠ¡å•†token\u003C\u002Fh4\u003E\u003Cp\u003Eæˆ‘ç”¨çš„æ˜¯DNSPodï¼Œæ‰€ä»¥è¿™é‡Œå°±è¯¦ç»†è¯´ä¸‹DNSPodæ€ä¹ˆè·å–tokenã€‚\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003Eç™»å½•DNSPodåå°\u003C\u002Fli\u003E\u003Cli\u003Eç‚¹å‡»å³ä¸Šè§’è‡ªå·±çš„å¤´åƒ\u003C\u002Fli\u003E\u003Cli\u003Eç‚¹å‡»å·¦ä¾§é€‰é¡¹å¡ä¼¤çš„çš„ \u003Ccode\u003EDNSPod Tokens\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\u003Cli\u003Eç‚¹å‡» \u003Ccode\u003Eåˆ›å»ºå¯†é’¥\u003C\u002Fcode\u003E åèµ·ä¸ªåå­—ï¼Œæ¥ç€å°±èƒ½æ‹¿åˆ°IDå’Œtokenå€¼ï¼Œå¦å¤–æ³¨æ„ï¼ŒTokenå€¼åªæ˜¾ç¤ºä¸€æ¬¡ï¼Œè¯·è®°å¥½å¤‡ä»½ã€‚\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cfigure class=\"kg-card kg-gallery-card kg-width-wide\"\u003E\u003Cdiv class=\"kg-gallery-container\"\u003E\u003Cdiv class=\"kg-gallery-row\"\u003E\u003Cdiv class=\"kg-gallery-image\"\u003E\u003Cimg src=\"https:\u002F\u002Fcdn.1900.live\u002Fassets\u002F2022\u002F09\u002F05Snipaste_2022-09-05_23-00-09.jpg\" width=\"632\" height=\"460\" loading=\"lazy\" alt\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"kg-gallery-image\"\u003E\u003Cimg src=\"https:\u002F\u002Fcdn.1900.live\u002Fassets\u002F2022\u002F09\u002F05Snipaste_2022-09-05_23-00-35.jpg\" width=\"1618\" height=\"695\" loading=\"lazy\" alt\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Ch4 id=\"%E8%AE%BE%E7%BD%AEdnspod-token\"\u003Eè®¾ç½®DNSPod token\u003C\u002Fh4\u003E\u003Cp\u003Eé€šè¿‡åœ¨å‘½ä»¤è¡Œé‡Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤è®¾ç½®tokenï¼Œè¦ä¸¥æ ¼æŒ‰æ ¼å¼æ¥ï¼Œ \u003Ccode\u003EDP_Id\u003C\u002Fcode\u003E åçš„ \u003Ccode\u003E=\u003C\u002Fcode\u003E å·å‰åä¸èƒ½æœ‰ç©ºæ ¼ã€‚ \u003Ccode\u003EDP_Id\u003C\u002Fcode\u003E ä¸ºDNSPodé‡Œç”Ÿæˆçš„ \u003Ccode\u003Eid\u003C\u002Fcode\u003E ï¼Œ \u003Ccode\u003EDP_Key\u003C\u002Fcode\u003E ä¸ºç”Ÿæˆçš„ \u003Ccode\u003Etoken\u003C\u002Fcode\u003E \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003Eexport DP_Id=\"\"\nexport DP_Key=\"\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"%E7%94%9F%E6%88%90\"\u003Eç”Ÿæˆ\u003C\u002Fh4\u003E\u003Cp\u003Eç”Ÿæˆè¯ä¹¦ï¼Œè¿™é‡Œä¸€å®šè¦å…ˆæ·»åŠ ä¸»åŸŸåï¼Œå†æ·»åŠ æ³›åŸŸåã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ \u003Ccode\u003E-d\u003C\u002Fcode\u003E æ¥æ·»åŠ å¤šä¸ªåŸŸåã€‚åŸŸåç”Ÿæˆåè¯ä¹¦æ–‡ä»¶ä¼šè‡ªåŠ¨å­˜æ”¾åœ¨ \u003Ccode\u003E.acme.sh\u003C\u002Fcode\u003E ç›®å½•é‡Œï¼Œæ–‡ä»¶å¤¹åç§°ä¸ºä½ æ·»åŠ çš„ä¸»åŸŸåã€‚\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003Eacme.sh   --issue   --dns dns_dp   -d aa.com  -d *.aa.com\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"%E5%AE%89%E8%A3%85%E8%AF%81%E4%B9%A6%E5%88%B0%E6%8C%87%E5%AE%9A%E7%9B%AE%E5%BD%95\"\u003Eå®‰è£…è¯ä¹¦åˆ°æŒ‡å®šç›®å½•\u003C\u002Fh3\u003E\u003Cp\u003Eå› ä¸ºæˆ‘ç”¨çš„Nginxï¼Œæ‰€ä»¥è¿™é‡Œè¯´ä¸€ä¸‹æ€ä¹ˆå®‰è£…åˆ°Nginxé‡Œã€‚\u003C\u002Fp\u003E\u003Cp\u003Eæˆ‘ä¹‹å‰çœ‹çš„æ•™ç¨‹æ˜¯ç›´æ¥cpè¯ä¹¦åˆ°nginxè¯ä¹¦ç›®å½•é‡Œï¼Œä½†æ˜¯çœ‹äº†å®˜æ–¹çš„è¯´æ˜å’Œå…¶ä»–ä¸€äº›ç½‘å‹åˆ†äº«çš„ç»éªŒæ‰çŸ¥é“æœ€å¥½æ˜¯é€šè¿‡å‘½ä»¤æ¥å®‰è£…è¯ä¹¦æ–‡ä»¶ã€‚\u003C\u002Fp\u003E\u003Cdiv class=\"kg-card kg-callout-card kg-callout-card-red\"\u003E\u003Cdiv class=\"kg-callout-emoji\"\u003EğŸ’¡\u003C\u002Fdiv\u003E\u003Cdiv class=\"kg-callout-text\"\u003Eæ³¨æ„, é»˜è®¤ç”Ÿæˆçš„è¯ä¹¦éƒ½æ”¾åœ¨å®‰è£…ç›®å½•ä¸‹: \u003Ccode\u003E~\u002F.acme.sh\u002F\u003C\u002Fcode\u003E, è¯·ä¸è¦ç›´æ¥ä½¿ç”¨æ­¤ç›®å½•ä¸‹çš„æ–‡ä»¶, ä¾‹å¦‚: ä¸è¦ç›´æ¥è®© nginx\u002Fapache çš„é…ç½®æ–‡ä»¶ä½¿ç”¨è¿™ä¸‹é¢çš„æ–‡ä»¶. è¿™é‡Œé¢çš„æ–‡ä»¶éƒ½æ˜¯å†…éƒ¨ä½¿ç”¨, è€Œä¸”ç›®å½•ç»“æ„å¯èƒ½ä¼šå˜åŒ–.\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cp\u003Eæˆ‘ä»¬éœ€è¦é€šè¿‡ \u003Ccode\u003E--install-cert\u003C\u002Fcode\u003E æ¥å®‰è£…è¯ä¹¦æ–‡ä»¶ï¼Œä½¿ç”¨å®˜æ–¹çš„è¿™ç§æ–¹å¼ä»¥åå¯ä»¥è‡ªåŠ¨æ— æ„Ÿç»­æœŸã€è‡ªåŠ¨æ›´æ–°ç­‰ã€‚å®˜æ–¹å®‰è£…è¯´æ˜reloadcmdä½¿ç”¨çš„æ˜¯ï¼š Â \u003Ccode\u003Eservice nginx force-reload\u003C\u002Fcode\u003E ï¼Œæˆ‘ç”¨çš„ä¸‹é¢çš„ï¼Œä¸çŸ¥é“ä¼šä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€‚ \u003C\u002Fp\u003E\u003Cfigure class=\"kg-card kg-code-card\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003Eacme.sh --install-cert -d example.com \\\n--key-file       \u002Fyoudata\u002Fssl\u002Fnginx\u002Fyourdomain.key  \\\n--fullchain-file \u002Fyoudata\u002Fssl\u002Fnginx\u002Ffullchain.cer \\\n--reloadcmd     \"sudo nginx -s reload\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cfigcaption\u003Eå®‰è£…è¯ä¹¦æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶è®¾ç½®é‡è½½å‘½ä»¤\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003Eè¿™æ ·åœ¨æŒ‡å®šç›®å½•ä¼šè‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„è¯ä¹¦æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åœ¨Nginxé…ç½®æ–‡ä»¶é‡Œè¿›è¡Œå¼•ç”¨å°±è¡Œäº†ã€‚\u003C\u002Fp\u003E\u003Ch4 id=\"%E7%BB%AD%E6%9C%9F\"\u003Eç»­æœŸ\u003C\u002Fh4\u003E\u003Cp\u003Eæˆ‘ä»¬å‰é¢åœ¨å®‰è£…acme.shçš„æ—¶å€™é»˜è®¤ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª \u003Ccode\u003Ecrontab\u003C\u002Fcode\u003E ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ \u003Ccode\u003Ecrontab -l\u003C\u002Fcode\u003E æŸ¥çœ‹ã€‚é»˜è®¤çš„è®¡åˆ’ä»»åŠ¡æ˜¯æ¯å¤©æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦éœ€è¦ç»­æœŸï¼Œå¦‚æœéœ€è¦åˆ™ä¼šè‡ªåŠ¨ç»­æœŸï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªç”±è®¾ç½®ä»»åŠ¡ï¼Œcrontabç¤ºä¾‹é…ç½®å¦‚ä¸‹ï¼š\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E56 * * * * \"\u002Froot\u002F.acme.sh\"\u002Facme.sh --cron --home \"\u002Froot\u002F.acme.sh\" &gt; \u002Fdev\u002Fnull\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"nginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\"\u003ENginxé…ç½®æ–‡ä»¶\u003C\u002Fh4\u003E\u003Cp\u003Eæˆ‘ä»¥å‰æ²¡æœ‰ç”¨ä»£ç ç‰‡æ®µæ¥ç®¡ç†sslè¯ä¹¦ï¼Œä¹Ÿä¸æ‡‚è¦æ€ä¹ˆå¼„ï¼Œè¿™æ¬¡åœ¨ \u003Ca href=\"https:\u002F\u002Flearnku.com\u002Farticles\u002F13496\u002Flets-encrypt-pan-domain-name-application-and-configuration?ref=1900.live\"\u003Eè¿™ç¯‡æ–‡ç« é‡Œ\u003C\u002Fa\u003E è§£é”äº†ä»£ç æ®µçš„ä½¿ç”¨ï¼ˆä½†æ˜¯è¿™ç¯‡æ–‡ç« çš„å…¶ä»–éƒ¨åˆ†éƒ½æ˜¯å‘ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ¯”è¾ƒè€çš„ç¼˜æ•…ï¼Œ4å¹´å‰çš„æ–‡ç« äº†ï¼‰\u003C\u002Fp\u003E\u003Cp\u003Eå…ˆåœ¨ \u003Ccode\u003E\u002Fetc\u002Fnginx\u002Fsnippets\u003C\u002Fcode\u003E ç›®å½•ä¸‹åˆ›å»ºä»£ç æ®µæ–‡ä»¶ \u003Ccode\u003Essl-params.conf\u003C\u002Fcode\u003E ä¸“é—¨æ‹¿æ¥é…ç½®SSLç›¸å…³çš„è®¾ç½®ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œç”¨çš„ä¹Ÿæ˜¯ä¸Šé¢é‚£ä½ä½œè€…çš„è®¾ç½®ï¼Œä¸çŸ¥é“4å¹´å‰çš„ä¸œè¥¿ç°åœ¨æ˜¯ä¸æ˜¯è¦æ”¹ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰çœ‹åˆ°è¿™é‡Œçš„å¤§ä½¬éº»çƒ¦æŒ‡ç‚¹ä¸€ä¸‹ã€‚\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"language-nginx\"\u003E# \u002Fetc\u002Fnginx\u002Fsnippets\u002Fssl-params.conf\n\nserver_tokens   off;\n\nssl_session_cache        shared:SSL:10m;\nssl_session_timeout      60m;\n\nssl_session_tickets      on;\n\nssl_stapling             on;\nssl_stapling_verify      on;\n\nresolver                 8.8.4.4 8.8.8.8  valid=300s;\nresolver_timeout         10s;\nssl_prefer_server_ciphers on;\n\n# è¯ä¹¦è·¯å¾„ ç»å¯¹åœ°å€\nssl_certificate          \u002Fyoudata\u002Fssl\u002Fnginx\u002Ffullchain.cer;\nssl_certificate_key      \u002Fyoudata\u002Fssl\u002Fnginx\u002Fyourdomain.key;\n\nssl_protocols            TLSv1 TLSv1.1 TLSv1.2;\n\nssl_ciphers \"EECDH+AESGCM:EDH+AESGCM:ECDHE-RSA-AES128-GCM-SHA256:AES256+EECDH:DHE-RSA-AES128-GCM-SHA256:AES256+EDH:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES128-SHA256:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:AES128-SHA:DES-CBC3-SHA:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!MD5:!PSK:!RC4\";\n\nadd_header Strict-Transport-Security \"max-age=31536000;includeSubDomains;preload\";\nadd_header  X-Frame-Options  deny;\nadd_header  X-Content-Type-Options  nosniff;\nadd_header x-xss-protection \"1; mode=block\";\nadd_header Content-Security-Policy \"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' blob: https:; connect-src 'self' https:; img-src 'self' data: https: blob:; style-src 'unsafe-inline' https:; font-src https:\";\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eæ¥ä¸‹æ¥å†æ–°å»ºä¸€ä¸ªnginxé…ç½®æ–‡ä»¶ï¼Œå¹¶é…ç½®serveré¡¹ï¼Œå¹¶åœ¨serveré¡¹é‡Œé€šè¿‡ \u003Ccode\u003Einclude\u003C\u002Fcode\u003E å‘½ä»¤å¯¼å…¥æˆ‘ä»¬ä¹‹å‰å†™çš„sslé…ç½®ä»£ç æ®µå³å¯ã€‚\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eserver {\n    listen 443 ssl;\n    server_name test.yourdomain.com;\n    \n    include snippets\u002Fssl-params.conf;\n\n  location \u002F {\n      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n      proxy_set_header X-Forwarded-Proto $scheme;\n      proxy_set_header X-Real-IP $remote_addr;\n      proxy_set_header Host $http_host;\n      proxy_pass http:\u002F\u002F127.0.0.1:15215;\n\n      # å¦‚æœæ‚¨è¦ä½¿ç”¨æœ¬åœ°å­˜å‚¨ç­–ç•¥ï¼Œè¯·å°†ä¸‹ä¸€è¡Œæ³¨é‡Šç¬¦åˆ é™¤ï¼Œå¹¶æ›´æ”¹å¤§å°ä¸ºç†è®ºæœ€å¤§æ–‡ä»¶å°ºå¯¸\n      # client_max_body_size 20000m;\n  }\n\n\n    location ~ \u002F.well-known {\n        allow all;\n    }\n\n    client_max_body_size 50m;\n}\n\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E","date":"5 September 2022","path":"acme-sh-generic-domain-certificate-generation-and-configuration"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.b62e6b44.js" defer></script><script src="/assets/js/page--src--templates--ghost-post-vue.9ef213ea.js" defer></script>
  </body>
</html>