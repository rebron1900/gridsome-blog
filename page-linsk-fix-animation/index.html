<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>只是玩玩 | JUST FUN - 只是玩玩 | JUST FUN</title><meta name="gridsome:hash" content="2cbfaa773c414da5c97e6a0cf2cb9fa9d7db58ae"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Hello"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/gridsome-blog/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/gridsome-blog/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/gridsome-blog/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/gridsome-blog/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/gridsome-blog/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/gridsome-blog/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/gridsome-blog/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/gridsome-blog/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/gridsome-blog/assets/css/0.styles.be694e5c.css" as="style"><link rel="preload" href="/gridsome-blog/assets/js/app.d87bab28.js" as="script"><link rel="preload" href="/gridsome-blog/assets/js/page--src--templates--ghost-post-vue.a078e51b.js" as="script"><link rel="prefetch" href="/gridsome-blog/assets/js/5.fd828304.js"><link rel="prefetch" href="/gridsome-blog/assets/js/page--node-modules--gridsome--app--pages--404-vue.5fb9a6b8.js"><link rel="prefetch" href="/gridsome-blog/assets/js/page--src--pages--index-vue.48502cc5.js"><link rel="stylesheet" href="/gridsome-blog/assets/css/0.styles.be694e5c.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body  class="darkmode">
    <main role="main" data-server-rendered="true" id="app" class="container"><div class="row"><header class="header"><a href="/gridsome-blog/" class="active"><h1>👨‍💻 只是玩玩 | JUST FUN</h1></a><!----></header><div class="article"><h1 class="article-title">页内锚点滚动修正及动画效果</h1><p class="article-date"> 31 October 2017 · <i> min read</i></p><article><!--kg-card-begin: markdown--><p>昨天在写引用时发现了一个页面上的BUG，在页面上点击文章内的对应的引用数字会跳转到页脚对应的引用区。但是因为我页面的头部有一条固定高度为<code>50px</code>的导航条，点击连接后虽然会跳转到引用区域，但是会被导航条遮住50px高度的内容。而且跳转没有过渡动画，很僵硬...</p>
<p>感觉这个可以用回到顶部中用到的修改元素的<code>data-offset</code>来解决这个问题，起初是想直接用js上的一个滚动框架来实现这个功能，后来发现改不来。干脆照着自己写了个函数。</p>
<p>先是查找下页面上所有锚点链接并用jquery绑定一个新的点击事件，选择器可以用css的属性选择器写法如<code>a[href^=&quot;#&quot;]</code>过滤所有以#符号开头的a链接。绑定一个点击函数，用<code>preventDefault</code>阻值默认的点击事件，然后用jquery的<code>animate</code>来实现动画效果的滚动，并滚动滚动条到目标元素的位置，并加上我导航条的高度修正<code>scrollTop: $(this.hash).offset()-55</code>，最终代码如下。</p>
<pre><code class="language-javascript">$('.post-content sup a[href^=&quot;#&quot;]').click(function(e){
                    e.preventDefault();
                    $('html, body').animate({scrollTop: $(this.hash).offset()-55}, 400);
                });
</code></pre>
<p>后来发现还有其他地方需要用到这个东西来做页面内的定位(比如定位到comment区等等)，所以把代码提取优化了一下，做了一个函数如下：</p>
<pre><code class="language-javascript">function linkEV(selector,fixSet = 0){
	$(selector).click(function(e){
                    e.preventDefault();
                    $('html, body').animate({scrollTop: $(this.hash).offset().top+fixSet}, 400);
                });
}
</code></pre>
<p>调用，传入不同选择器和修正数值即可灵活引用了。</p>
<pre><code class="language-javascript">linkEV('.post-content blockquote[id^=&quot;fn&quot;]  a[href^=&quot;#&quot;]',-55);
linkEV('.post-content sup a[href^=&quot;#&quot;]',-55);
</code></pre>
<p>具体效果可以看我<a href="https://1900.live/auto-push-hexo/">这篇文章</a></p>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="100%" height="86" src="//music.163.com/outchain/player?type=2&id=513357806&auto=1&height=66"></iframe><!--kg-card-end: markdown--></article></div><div class="footer"><div><p>
          Built with
          <a target="_blank" href="//gridsome.org" class="link">Gridsome</a>
          &amp; Made with ❤️ by
          <a target="_blank" href="//alex.design" class="link">Alex Brown</a></p></div><div class="footer-links"><a target="_blank" href="/sitemap.xml">Sitemap</a><a target="_blank" href="/feed.xml">RSS Feed</a></div></div></div></main>
    <script>window.__INITIAL_STATE__={"data":{"metadata":{"siteName":"只是玩玩 | JUST FUN","siteDescription":"Hello"},"post":{"id":"63158312cf533d1c2cf299bd","title":"页内锚点滚动修正及动画效果","content":"\u003C!--kg-card-begin: markdown--\u003E\u003Cp\u003E昨天在写引用时发现了一个页面上的BUG，在页面上点击文章内的对应的引用数字会跳转到页脚对应的引用区。但是因为我页面的头部有一条固定高度为\u003Ccode\u003E50px\u003C\u002Fcode\u003E的导航条，点击连接后虽然会跳转到引用区域，但是会被导航条遮住50px高度的内容。而且跳转没有过渡动画，很僵硬...\u003C\u002Fp\u003E\n\u003Cp\u003E感觉这个可以用回到顶部中用到的修改元素的\u003Ccode\u003Edata-offset\u003C\u002Fcode\u003E来解决这个问题，起初是想直接用js上的一个滚动框架来实现这个功能，后来发现改不来。干脆照着自己写了个函数。\u003C\u002Fp\u003E\n\u003Cp\u003E先是查找下页面上所有锚点链接并用jquery绑定一个新的点击事件，选择器可以用css的属性选择器写法如\u003Ccode\u003Ea[href^=&quot;#&quot;]\u003C\u002Fcode\u003E过滤所有以#符号开头的a链接。绑定一个点击函数，用\u003Ccode\u003EpreventDefault\u003C\u002Fcode\u003E阻值默认的点击事件，然后用jquery的\u003Ccode\u003Eanimate\u003C\u002Fcode\u003E来实现动画效果的滚动，并滚动滚动条到目标元素的位置，并加上我导航条的高度修正\u003Ccode\u003EscrollTop: $(this.hash).offset()-55\u003C\u002Fcode\u003E，最终代码如下。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003E$('.post-content sup a[href^=&quot;#&quot;]').click(function(e){\n                    e.preventDefault();\n                    $('html, body').animate({scrollTop: $(this.hash).offset()-55}, 400);\n                });\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E后来发现还有其他地方需要用到这个东西来做页面内的定位(比如定位到comment区等等)，所以把代码提取优化了一下，做了一个函数如下：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003Efunction linkEV(selector,fixSet = 0){\n\t$(selector).click(function(e){\n                    e.preventDefault();\n                    $('html, body').animate({scrollTop: $(this.hash).offset().top+fixSet}, 400);\n                });\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E调用，传入不同选择器和修正数值即可灵活引用了。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003ElinkEV('.post-content blockquote[id^=&quot;fn&quot;]  a[href^=&quot;#&quot;]',-55);\nlinkEV('.post-content sup a[href^=&quot;#&quot;]',-55);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E具体效果可以看我\u003Ca href=\"https:\u002F\u002F1900.live\u002Fauto-push-hexo\u002F\"\u003E这篇文章\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ciframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=\"100%\" height=\"86\" src=\"\u002F\u002Fmusic.163.com\u002Foutchain\u002Fplayer?type=2&id=513357806&auto=1&height=66\"\u003E\u003C\u002Fiframe\u003E\u003C!--kg-card-end: markdown--\u003E","date":"31 October 2017","path":"page-linsk-fix-animation"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/gridsome-blog/assets/js/app.d87bab28.js" defer></script><script src="/gridsome-blog/assets/js/page--src--templates--ghost-post-vue.a078e51b.js" defer></script>
  </body>
</html>